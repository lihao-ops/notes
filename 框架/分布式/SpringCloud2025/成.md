##### 公共module 

80与8001之间**重复的代码抽离，项目代码进行优化重构**。

>ResultData、ReturnCodeEnum、PayDTO等代码在两个服务中均存在，还有**通用的组件、接口、工具类……**那么有什么办法可以将它们抽离，使得代码变的更加简洁，利用率更高呢？

于是在我们的cloud20224微服务中**新建一个module`cloud-api-commons`专门用来存放通用的代码**。以供其它所有的微服务重复使用。

- 例如公司存在多个部门。
- 但是所有的部门员工工资与公费支出都需要走统一的财务部！
- 那么`“财务部”`就是`cloud-api-commons`

###### 1.建module

![image-20250104142925239](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202501041429570.png)



###### 2.改pom

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>com.atguigu.cloud</groupId>
        <artifactId>cloud2024</artifactId>
        <version>1.0-SNAPSHOT</version>
    </parent>

    <artifactId>cloud-api-commons</artifactId>

    <properties>
        <maven.compiler.source>17</maven.compiler.source>
        <maven.compiler.target>17</maven.compiler.target>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    </properties>



    <dependencies>
        <!--SpringBoot通用依赖模块-->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>
        <!--hutool-->
        <dependency>
            <groupId>cn.hutool</groupId>
            <artifactId>hutool-all</artifactId>
        </dependency>
    </dependencies>

</project>
```





###### 3.抽离公共代码到此commons中，再install

>重复代码抽离到此module中

![image-20250104143338484](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202501041433548.png)





###### 4.将commons模块作为maven的本地库一样调用

将commons模块作为maven的本地库一样调用

点击右上角的maven图标——>选择`cloud-api-commons`——>点击`Lifecycle`——先执行`clean`——>最后执行`install`。这样它就可以作为一个依赖包来使用，依赖包中的内容，就是当前`commons`module的公共部分代码。

![image-20250104143733793](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202501041437895.png)

检查最终为`BUILD SUCCESS`!

![image-20250104144137810](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202501041441907.png)





###### 5.在其它module中引入此包，删除重复代码改为调用此包中的通用代码。

```xml
        <!--引入自定义的api通用包-->
        <dependency>
            <groupId>com.atguigu.cloud</groupId>
            <artifactId>cloud-api-commons</artifactId>
            <version>1.0-SNAPSHOT</version>
        </dependency>
```



###### 6.删除放入`commons`中的通用代码

![image-20250104145016289](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202501041450380.png)



###### 7.测试

>测试无误，在8001和80两个module中的公共代码都删除后，服务依旧运行正常。可以确认它们使用的是`commons`中的公共代码

![image-20250104145342473](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202501041453594.png)





### base工程完结详情图

>不包含`commons`module

![image-20250104150111334](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202501041501432.png)



注：至此下图中所有环节初步架构均已完成

![image-20250104150407303](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202501041504397.png)









