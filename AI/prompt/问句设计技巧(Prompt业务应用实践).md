# 问句设计技巧(Prompt业务应用实践)



## 一、背景

### 1.OpenAI大模型发展变迁史

- 11 June 2018（GPT）
- 14 Feb 2019（GPT-2）
- 11 June 2020（GPT-3 & OpenAI API）
- 5 Jan 2021（DALL-E）
- 6 Apr 2022（DALL-E 2）
- 30 Nov 2022（**ChatGPT**）





### 2.已经落地LLM

![img](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202410111352555.png)

>什么是LLM

LLM：Large Language Model大语言模型





### 3.语言模型原理

>原理：文字接龙

1. **输入**：（不完整的句子）**“你好”**
2. **LLM**
3. **输出**：(一个可能的字)     **“美”**



> “跟人类对话”

- 输入：”跟“
  - 输出：”人“ 或 ”你“ 或 ”车“；
- 输入：“跟人”
  - 输出：“类” 或 “学习”；
- 输入：“跟人类”
  - 输出：“对” 或 “沟通”；
- 输入：“跟人类对”
  - 输出：“话”；







### 4.概率输出

>概率分布随机采样

如何引导模型输出我们想要的下一个字？

1. 输入：（不完整的句子）
   - 你好
2. GPT
   1. 模型采样策略
      - 高 20%
      - 美 30%
      - 吗 80%



>GPT模型采样策略

- Greedy Sampling：选取概率最大的
- Top-k Sampling：保留前k个最可能的，再随机采样
- Top-p Sampling：保留累积概率 > 某个阀值p，再随机采样







### 5.输出结果质量

在业务实践中发现要让LLM输出结果准确、稳定，还是不容易的！



>如何引导GPT输出有用内容？

- 问：中国的首都是？
  - GPT答：北



- 问：中国的首都是？
  - GPT答：京



- 问：中国的首都是？
  - GPT答：北京/A.上海，B.北京/查询其它分支获取答案







## 二、Prompt介绍



### 1.结构认知1

- `Prompt`是通过指令和上下文传递给LLM完成任务，提示工程就是对提示进行开发和优化以达到更有效的使用LLM。
- `LLM`类似一个**操作系统**，prompt是发给操作系统需要完成任务的指令集。
- `指令集`就需要有结构，有语法，自然就有输入有输出。
- `prompt`也可以理解为**具体的功能需求说明**。



>说明

1. **任务说明**：希望模型执行的特定任务或指令。
2. **上下文**：提供背景信息，包含外部信息或额外的上下文信息，有助于引导模型更好的响应。
3. **输入数据**：告知模型需要处理的数据。
4. **输出指示**：指定模型要输出的类型或格式。







### 2.结构认知2

>一个Prompt大概包含以下要素

- 指令（Instruction）
- 上下文（Context）
- 输入数据（Input Data）
- 输出指示（Output Indicator）





#### 示例(拆分按照小标题顺序排序)

>3.指令(Instruction)

 请对下面的推文分类：



>2.示例(Example)

 以下是一些积极和消极推文的例子。 

Q: 推文: "今天真是美好的一天！"这条推文是积极的还是消极的？ 

A: 积极的 

Q: 推文: 我讨厌这个班级"这条推文是积极的还是消极的？ 

A: 消极的 



>1.上下文(Context)

Twitter是一个社交媒体平台，用户可以发布称为“推文”的短消息。 推文可以是积极的或消极的，我们希望能够将推文分类为积极或消 极。 



>4.问题(Question)

 Q: 推文: "我喜欢牛仔裤上的口袋“ 

A: 



> 注

提示的具体格式取决于任务需求和类型，**并非所有要素都是必须的**。





### 3.结构认知3

> 结合大量的prompt案例和我们实际的业务场景，提炼了一种适合程序工程化的prompt结构

1. **用户输入**
2. **Prompt**
3. **业务集成**
4. **结果输出**





## 三、Prompt应用案例

###  自动生成客户提问数据1 

> User： 

​	假设你是个研究员，请针对上海GDP进行多角度多方面的五个提问。问题中不一定需要包 含“上海GDP”。使用中文。 

> ChatGPT：

 	1. 上海市经济发展的主要驱动力是什么？ 
 	  	2. 上海市GDP的增速如何，与其他城市相比如何？ 
 	     	3. 上海市经济结构的特点和趋势是什么？ 
 	              	4. 上海市GDP增长的潜在风险有哪些，如何应对？ 
 	           	5. 上海市如何提高GDP质量和可持续性发展水平？  





###  自动生成客户提问数据2 

> User： 

​	什么是上海GDP？上海GDP和哪些宏观经济指标相关？ 

> ChatGPT： 

上海GDP与许多宏观经济指标相关，包括但不限于以下几项： 

1. 国内生产总值（GDP）：上海GDP是国内生产总值的一个组成部分，反映了上海市在国内经济中的地位和作用。 

2. 。。。 综上所述，上海GDP与许多宏观经济指标相关，这些指标相互作用，共同影响着上海市的经济增长和发展。 

   User： 假设你是个研究员，请针对上海GDP进行多角度多方面的五个提问。问题中不一定需要包含“上海GDP”。使用中文。 

   ChatGPT： 好的，我可以提供一些关于上海经济发展的问题，从不同的角度来探讨。 

   1. 上海市的经济结构是怎样的？哪些产业对上海的经济增长起了重要作用？ 
   2. 上海市的居民收入水平如何？收入差距是否加大？
   3. 上海市的经济发展对环境有何影响？在可持续发展方面，上海市有哪些举措？ 
   4. 上海市在国际贸易中扮演了怎样的角色？上海的进口和出口贸易有何特点？ 
   5. 上海市的城市规划和城市建设如何？哪些措施被采取来改善城市交通和基础设施建设？  




### 竞品分析

```bash
Q：
作为bloomerg的产品经理，我需要设计一个问答机器人。请问这个问答机器人的功能应该从哪些
方面考虑？
A：
设计一个针对Bloomberg产品的问答机器人，需要从以下几个方面考虑其功能：
1. 了解Bloomberg产品：问答机器人需要了解Bloomberg提供的哪些产品，针对用户提出的问题，精
确判断所属类别，从而提供更加准确的答案。
2. 完善的问题分类机制：根据Bloomberg产品的特性，将问题分类，例如市场走势、股票、基金等，
对于用户提出的问题进行准确分类，以提供更加专业的答案。
3. 数据挖掘和分析：Bloomberg为用户提供了大量的数据，问答机器人可以通过数据挖掘和分析的
方式，给出更加准确的答案和结论。
4. 自然语言处理：为了更好地满足用户的需求，问答机器人需要具备自然语言处理能力，能够
识别用户的意图，理解用户的提问，并返回一个准确、有用的答案。
5. 个性化推荐：问答机器人可以根据用户的历史提问记录，提供个性化的推荐答案，进一步提
升用户体验。
```





###  逆向思路 

```bash
Q：语言模型怎么将用户输入信息修正为专业表达方式？
A：
语言模型可以通过训练大量的语料库来学习自然语言的规律和模式，从而能够理解和分析用户
的问题，并将其转化为专业表达方式。
具体来说，语言模型可以通过以下几个步骤将用户的问题修正为专业表达方式：
[
1. 分词：将用户输入的句子进行分词，将其拆分成一个个单词或短语。
2. 词性标注：对分词后的单词或短语进行词性标注，以便更好地理解其在句子中的作用和意义。
3. 句法分析：对句子进行句法分析，确定句子的结构和成分，以便更好地理解其语义。
4. 语义分析：通过对句子的语义进行分析，确定用户的意图和需求。
5. 生成专业表达方式：根据用户的意图和需求，语言模型可以生成专业表达方式，包括专业术
语、语法结构等，以便更好地回答用户的问题。
]
总之，语言模型通过对自然语言的理解和分析，可以将用户的问题修正为专业表达方式，从而
更好地满足用户的需求。
```





## 四、Prompt技巧





### 1.参数格式化输出

>执行prompt输出json格式数据，对业务系统对接比较友好

```bash
… ... 省略 … ... ###任务流程###
1.请一步一步思考问题，按照上面模板一个一个解决问题。
2.上面的步骤及信息都不展示！
###输出格式###
{"abstract":"","startTime":"","endTime":"","timeRange":"","companyName":["",""],"industrySector":["",""],"indicators":["",""],"reportDate":["",""],"reportType":["
",""],"dataType":"{数据类型编号}","financialMarket":"{金融市场编号}"}
###执行任务###
1.请你按照“任务流程”，并且严格按照“输出格式”输出数据！不要展示其他信息！
2.再次强调一下，当前是{nowyear}年！
3.请输入问题: {input}
###结束###
```





### 2.参数填充指定

>定义好prompt输出格式

```bash
在任务上 下文描述中，需要尽量细致，对每个参数准确定义解释，并说明value填在对应的key上，可以增加prompt 输出结果的稳定性。
```





### 3.深度提问

​	用户输入的信息，可能是一个问题，可能是一段描述，也可能是一个不完整的语句。如果没有清晰的输入信息，就不能准确识别用户真正的意图。

​	鉴于此，通过prompt设计：

1. **将输入信息进行专业化的表达，**
2. **然后识别用户的意图，**
3. **根据意图拆解问题，**
4. **最后找出子问题的答案，**
5. **再总结答案。**



​	这个过程中，语言模型已经产生了很多看不见的“堆栈”信息。**从该“堆栈”信息中提取相关参数，比直接从该用户输入信息中提取信息，准确概率大很多。**如果只是通过输入信息提取参数，可能仅仅是获取模型分词后的信息。

```bash
[
1.请将用户输入的信息自动完善，并且修正为专业的问题表
达方式，标记为R
2.请根据“R”仔细分析总结其背后的逻辑关系，并认真思考
用户的多个意图！
3.为了更好的回答用户问题，请你把“用户的多个意图”拆
解成多个“子问题”！
4.问题拆解一定要准确和细致！
5.请你认真分析每个“子问题”，并且总结答案！
6.基于获得的上述信息，尽可能多地找出与企业相关的指标，
指标名称要具体，写到“indicators”数组！
]
```





### 4.任务问题拆解

>为了更准确的回答用户问题，我们将用户提供的信息作为任务需求。然后将需求拆解成任务问题，一个一个解决问题。最后将每个任务问题及答案，围绕用户的诉求做总结。