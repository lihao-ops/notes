# kafka

官网地址：https://kafka.apache.org/documentation.html#introduction

---



## 一、基础概念

### 1.简而言之，Kafka是如何工作的？

​	**Kafka 是一个分布式系统，由服务器**和**客户端** 组成，它们通过高性能[TCP 网络协议](https://kafka.apache.org/protocol.html)进行通信。它可以部署在本地和云环境中的裸机硬件、虚拟机和容器上。

​	**服务器**：Kafka 由一台或多台服务器组成集群运行，这些服务器可以跨越多个数据中心或云区域。其中一些服务器构成存储层，称为代理 (broker)。其他服务器运行 [Kafka Connect](https://kafka.apache.org/documentation/#connect)，以事件流的形式持续导入和导出数据，从而将 Kafka 与您现有的系统（例如关系数据库）以及其他 Kafka 集群集成。为了帮助您实现关键任务用例，Kafka 集群具有高度的可扩展性和容错能力：如果其中任何一台服务器发生故障，其他服务器将接管其工作，以确保持续运行且不会丢失任何数据。

​	**客户端**：它们允许您编写分布式应用程序和微服务，以便能够并行、大规模地读取、写入和处理事件流，并且即使在网络问题或机器故障的情况下也能保持容错能力。Kafka 内置了一些客户端，此外， Kafka 社区还提供了[数十个客户端，](https://cwiki.apache.org/confluence/display/KAFKA/Clients)包括 Java 和 Scala 客户端（包括更高级别的 [Kafka Streams](https://kafka.apache.org/documentation/streams/)库），以及 Go、Python、C/C++ 和许多其他编程语言的客户端，以及 REST API。

---



### 2.[主要概念和术语](https://kafka.apache.org/documentation.html#intro_concepts_and_terms)

​	事件记录了世界上或您的业务中“发生的事情”。在文档中**，**它也被称为记录或消息。当您向 Kafka 读取或写入数据时，您是以事件的形式进行的。从概念上讲，事件包含键、值、时间戳和可选的元数据标头。以下是一个示例事件：

- 事件键：“爱丽丝”
- 事件值：“向鲍勃支付 200 美元”
- 事件时间戳：“2020年6月25日下午2:06”

​	**生产者**是向 Kafka 发布（写入）事件的客户端应用程序，而**消费者**是订阅（读取和处理）这些事件的应用程序。在 Kafka 中，生产者和消费者完全解耦，彼此互不影响，这是 Kafka 实现其高可扩展性的关键设计元素。例如，生产者无需等待消费者。Kafka 提供了各种[保证](https://kafka.apache.org/documentation/#semantics)，例如“恰好一次”处理事件的能力。

​	事件被组织并持久存储在**主题 (topic)**中。简而言之，主题类似于文件系统中的文件夹，而事件就是该文件夹中的文件。例如，主题名称可以是“payments”。Kafka 中的主题始终支持多生产者和多订阅者：一个主题可以有零个、一个或多个向其写入事件的生产者，以及零个、一个或多个订阅这些事件的消费者。主题中的事件可以根据需要随时读取——与传统消息系统不同，主题中的事件不会在消费后被删除。相反，您可以通过每个主题的配置设置来定义 Kafka 应保留事件的时间，超过此时间后，旧事件将被丢弃。Kafka 的性能在数据大小方面实际上保持恒定，因此长期存储数据完全没问题。

​	主题是**分区的**，这意味着一个主题会分布在位于不同 Kafka 代理上的多个“存储桶”中。这种分布式数据放置方式对于可扩展性至关重要，因为它允许客户端应用程序同时从多个代理读取数据或向多个代理写入数据。当新事件发布到主题时，它实际上会被附加到该主题的某个分区中。具有相同事件键（例如，客户或车辆 ID）的事件会被写入同一个分区，并且 Kafka[保证](https://kafka.apache.org/documentation/#semantics)给定主题分区的任何消费者始终会按照写入顺序读取该分区的事件。

![streams-and-tables-p1_p4](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202505171614035.png)

​	图：此示例主题包含四个分区 P1–P4。两个不同的生产者客户端彼此独立地通过网络将事件写入主题的各个分区，从而向主题发布新事件。具有相同键（图中以颜色表示)的事件将被写入同一分区。请注意，如果适用，两个生产者都可以写入同一分区。

​	为了确保数据容错和高可用性，每个主题都可以进行**复制**，甚至可以跨地理区域或数据中心进行复制。这样，在出现问题、需要对代理进行维护等情况下，始终有多个代理拥有数据副本。常见的生产环境设置是复制因子为 3，即始终有三个数据副本。此复制在主题分区级别执行。

文档的[“设计”](https://kafka.apache.org/documentation/#design)部分详细解释了 Kafka 的各种概念。













































































































































































































































































































































