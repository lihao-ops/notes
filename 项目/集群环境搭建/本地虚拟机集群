# æœ¬åœ°è™šæ‹Ÿæœºé›†ç¾¤ç¯å¢ƒæ­å»º



## å‰ç½®å‡†å¤‡

- CentOS-7-x86_64-DVD-2009.iso
- jdk-17.0.12
- VMware Workstation
- 3å°node







### VM å»ºè®®è®¾ç½®ï¼ˆåˆ›å»ºä¸‰å° node1/node2/node3ï¼‰

- Name: node1 / node2 / node3
- Guest OS: Linux â†’ CentOS 7 (64-bit)
- CD/DVD: æŒ‚è½½ CentOS-7-x86_64-DVD-2009.iso
- CPU: 3 vCPU
- Memory: 8 GB (8192 MB)
- Network: NAT æˆ– Host-only / è‡ªå®šä¹‰ VMnetï¼ˆé€‰ç”¨ Host-only/å†…éƒ¨ç½‘ç»œå¹¶ä¸ºæ¯å°åˆ†é…å›ºå®šå†…ç½‘ IPï¼‰
- Hard Disk: 25 GB (single virtual disk)
- USB controller: optional
- Other: Enable "Fit all virtual machine memory into reserved host RAM" if available to avoid overcommit (optional)





### è™šæ‹Ÿæœºç¯å¢ƒæ­å»º



#### é€‰æ‹©å…¸å‹

<img src="https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202510041736178.png" alt="image-20251004173648120" style="zoom:50%;" />





#### é€‰ç°åœ¨å®‰è£…æ“ä½œç³»ç»Ÿ

>ä½¿ç”¨æŒ‡å®šé•œåƒå®‰è£…ç³»ç»Ÿ

<img src="https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202510041807696.png" alt="image-20251004180750602" style="zoom:50%;" />





#### é…ç½®

>ç¡¬ä»¶

<img src="https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202510051850018.png" alt="image-20251005185051978" style="zoom:50%;" />



>é€‰é¡¹

<img src="https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202510051851237.png" alt="image-20251005185118194" style="zoom:50%;" />









#### å–æ¶ˆè¿›å…¥å›¾å½¢åŒ–ç•Œé¢



##### 1.å…ˆç”±å›¾å½¢åŒ–ç•Œé¢è¿›å…¥å‘½ä»¤è¡Œç•Œé¢

>å¿«æ·é”®

```bash
Ctrl + Alt + F2
```



##### 2.æŸ¥çœ‹å½“å‰çŠ¶æ€

>æ­¤ä¸ºé»˜è®¤å¼€æœºè¿›å…¥å›¾å½¢åŒ–ç•Œé¢çŠ¶æ€

```bash
[root@localhost ~]# systemctl get-default 
graphical.target
```



##### 3.æ›´æ”¹çŠ¶æ€ä¸ºé»˜è®¤å¼€æœºè¿›å…¥å‘½ä»¤è¡ŒçŠ¶æ€

>æ°¸ä¹…é»˜è®¤è¿›å…¥å‘½ä»¤è¡Œ

```bash
[root@localhost ~]# systemctl set-default multi-user.target 
```

>è¾“å‡º

```bash
Removed symlink /etc/systemd/system/default.target.
Created symlink from /etc/systemd/system/default.target to /usr/lib/systemd/system/multi-user.target.
```



##### 4.æµ‹è¯•

>æŸ¥çœ‹å½“å‰æ˜¯å¦å·²æ›´æ”¹ä¸ºå‘½ä»¤è¡ŒçŠ¶æ€`multi-user.target`

```bash
[root@localhost ~]# systemctl get-default 
multi-user.target
```

è¯´æ˜ï¼šå·²æ›´æ”¹æˆåŠŸ



>é‡å¯æµ‹è¯•

```bash
[root@localhost ~]# reboot 
```



>æµ‹è¯•æˆåŠŸ

å·²ç»é»˜è®¤å¼€æœºè¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼









#### xshellè¿æ¥

>æŸ¥çœ‹è™šæ‹Ÿæœºä¸­çš„ip

```bash
ip a
```

>ä½¿ç”¨ä¸‹é¢çš„IPæ¥è¿æ¥å§ï¼Œå±€åŸŸç½‘çš„IPéšç€ä½ æ›´æ¢wifiä¼šå‡ºç°æ›´æ”¹ï¼Œæ‰€ä»¥ç”¨æœ€ä¸‹é¢çš„æ•´ä¸ª`192.168.122.1`

![image-20251005182127561](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202510051821682.png)



```txt
ssh://root:**********@192.168.122.1:22
```







#### å…‹éš†



##### å…‹éš†å½“å‰`node1`ä¸º`node2`/`node3`

![image-20251005194903759](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202510051949805.png)





##### è§£å†³å…‹éš†åIPä¸€è‡´é—®é¢˜



å¦‚æœä½ å…‹éš†äº†è¿™å°è™šæ‹Ÿæœºï¼Œé‚£ä¹ˆæ–°çš„è™šæ‹Ÿæœºä¼š**å¤åˆ¶åŒä¸€ä¸ª MAC åœ°å€å’Œ DHCP æ ‡è¯†**ã€‚
 â†’ æ‰€ä»¥ DHCP æœåŠ¡å™¨ä¼šè®¤ä¸ºè¿™æ˜¯åŒä¸€å°æœºå™¨ï¼Œåˆ†é…ç›¸åŒçš„ IPã€‚
 â†’ å¯¼è‡´ä½ è¯´çš„â€œIP ä¸€æ ·â€ç°è±¡ã€‚



>å…ˆå¤‡ä»½é…ç½®

```ba
cp -p /etc/sysconfig/network-scripts/ifcfg-ens33 /etc/sysconfig/network-scripts/ifcfg-ens33_back
```



###### âš™ï¸ äºŒã€æ­£ç¡®ä¿®å¤æ­¥éª¤ï¼ˆå…‹éš†åçš„æœºå™¨æ‰§è¡Œï¼‰

åœ¨å…‹éš†å‡ºæ¥çš„æ¯å° CentOS7 è™šæ‹Ÿæœºä¸Šæ‰§è¡Œä»¥ä¸‹æ“ä½œğŸ‘‡

------

###### âœ… ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹ç½‘å¡é…ç½®æ–‡ä»¶

ç¼–è¾‘ï¼š

```
vi /etc/sysconfig/network-scripts/ifcfg-ens33
```

åˆ é™¤ä»¥ä¸‹ä¸¤è¡Œï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼š

```
HWADDR=00:0c:29:33:0d:e4
UUID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
```

æŸ¥çœ‹ååªæœ‰UUID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxxè¿™æ ·çš„ï¼Œå·²åˆ é™¤



ç¡®è®¤ `BOOTPROTO=dhcp` å­˜åœ¨ï¼š

```
BOOTPROTO=dhcp
ONBOOT=yes
```

å·²ç¡®è®¤å­˜åœ¨

ä¿å­˜é€€å‡ºã€‚

------

###### âœ… ç¬¬äºŒæ­¥ï¼šé‡æ–°ç”Ÿæˆæœºå™¨æ ‡è¯†ï¼ˆå…³é”®ï¼‰

æ‰§è¡Œï¼š

```
rm -f /etc/machine-id
systemd-machine-id-setup
```

> è¿™ä¸€æ­¥ä¼šè®©ç³»ç»Ÿæ‹¥æœ‰ä¸€ä¸ªæ–°çš„å”¯ä¸€æœºå™¨ IDï¼Œé¿å…å’ŒåŸè™šæ‹Ÿæœºå†²çªã€‚

------

###### âœ… ç¬¬ä¸‰æ­¥ï¼šé‡å¯ç½‘ç»œæœåŠ¡

```
systemctl restart network
```

æˆ–ç›´æ¥é‡å¯ï¼š

```
reboot
```

é‡å¯åå†æ‰§è¡Œï¼š

```
ip addr
```

ä½ åº”è¯¥èƒ½çœ‹åˆ° **æ–°çš„ MAC åœ°å€å’Œä¸åŒçš„ IP åœ°å€**ã€‚











#### é…ç½®é›†ç¾¤ç½‘ç»œç¯å¢ƒ

##### æ³¨æ„ï¼šå¦‚æœæ˜¯å…‹éš†çš„æœºå™¨å‰ææ˜¯è¦

###### âœ… ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹ç½‘å¡é…ç½®æ–‡ä»¶

ç¼–è¾‘ï¼š

```
vi /etc/sysconfig/network-scripts/ifcfg-ens33
```

åˆ é™¤ä»¥ä¸‹ä¸¤è¡Œï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼š

```
HWADDR=00:0c:29:33:0d:e4
UUID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
```

æŸ¥çœ‹ååªæœ‰UUID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxxè¿™æ ·çš„ï¼Œå·²åˆ é™¤



ç¡®è®¤ `BOOTPROTO=dhcp` å­˜åœ¨ï¼š

```
BOOTPROTO=dhcp
ONBOOT=yes
```

å·²ç¡®è®¤å­˜åœ¨

ä¿å­˜é€€å‡ºã€‚

------

###### âœ… ç¬¬äºŒæ­¥ï¼šé‡æ–°ç”Ÿæˆæœºå™¨æ ‡è¯†ï¼ˆå…³é”®ï¼‰

æ‰§è¡Œï¼š

```
rm -f /etc/machine-id
systemd-machine-id-setup
```

> è¿™ä¸€æ­¥ä¼šè®©ç³»ç»Ÿæ‹¥æœ‰ä¸€ä¸ªæ–°çš„å”¯ä¸€æœºå™¨ IDï¼Œé¿å…å’ŒåŸè™šæ‹Ÿæœºå†²çªã€‚











##### æ¯å°è™šæ‹Ÿæœºé…ç½®åŒç½‘ç»œé€‚é…å™¨

- Host-only ç½‘å¡æœ¬è´¨æ˜¯å®¿ä¸»æœºå’Œè™šæ‹Ÿæœºä¹‹é—´çš„ä¸€ä¸ªç‹¬ç«‹ç½‘æ®µï¼ˆè™šæ‹Ÿå†…ç½‘ï¼‰ï¼Œä¸ä¾èµ–å¤–éƒ¨ç‰©ç†ç½‘ç»œã€‚
- é™æ€ IP è®©æ¯å°è™šæ‹Ÿæœºçš„åœ°å€å›ºå®šï¼ŒXshell ä¸ç”¨æ¯æ¬¡æŸ¥ IPã€‚
- NAT ç½‘å¡ä¿ç•™ç»™è™šæ‹Ÿæœºè®¿é—®å¤–ç½‘ï¼ŒHost-only ç½‘å¡è´Ÿè´£ SSH å’Œé›†ç¾¤é€šä¿¡ã€‚

>è¿™æ ·ä¸åŒçš„wifiä¸‹ï¼Œä¹Ÿå¯ä»¥ä¿æŒIPä¸€è‡´ï¼



###### é…ç½®ä¸åŒwifiä¸‹ä¾ç„¶ä¿æŒIPä¸”xshellè¿æ¥æ­£å¸¸



<img src="C:\Users\lihao\AppData\Roaming\Typora\typora-user-images\image-20251005203320133.png" alt="image-20251005203320133" style="zoom:50%;" />







###### æ¡¥æ¥(IPéšæœº33)

<img src="https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202510052138102.png" alt="image-20251005213828037" style="zoom:50%;" />



###### å›ºå®š

<img src="https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202510071849621.png" alt="image-20251007184934547" style="zoom:50%;" />





###### æŸ¥çœ‹windowsæœ¬æœºIPæƒ…å†µ

```bash
ipconfig
```

```bash
ä»¥å¤ªç½‘é€‚é…å™¨ VMware Network Adapter VMnet1:

   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . :
   æè¿°. . . . . . . . . . . . . . . : VMware Virtual Ethernet Adapter for VMnet1
   ç‰©ç†åœ°å€. . . . . . . . . . . . . : 00-50-56-C0-00-01
   DHCP å·²å¯ç”¨ . . . . . . . . . . . : æ˜¯
   è‡ªåŠ¨é…ç½®å·²å¯ç”¨. . . . . . . . . . : æ˜¯
   æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::9fae:f90f:651d:dc48%9(é¦–é€‰)
   IPv4 åœ°å€ . . . . . . . . . . . . : 192.168.254.1(é¦–é€‰)
   å­ç½‘æ©ç   . . . . . . . . . . . . : 255.255.255.0
   è·å¾—ç§Ÿçº¦çš„æ—¶é—´  . . . . . . . . . : 2025å¹´10æœˆ7æ—¥ 17:46:21
   ç§Ÿçº¦è¿‡æœŸçš„æ—¶é—´  . . . . . . . . . : 2025å¹´10æœˆ7æ—¥ 18:38:38
   é»˜è®¤ç½‘å…³. . . . . . . . . . . . . :
   DHCP æœåŠ¡å™¨ . . . . . . . . . . . : 192.168.254.254
   DHCPv6 IAID . . . . . . . . . . . : 587223126
   DHCPv6 å®¢æˆ·ç«¯ DUID  . . . . . . . : 00-01-00-01-2F-A8-7A-43-B0-25-AA-82-80-57
   TCPIP ä¸Šçš„ NetBIOS  . . . . . . . : å·²å¯ç”¨
```

ä¹Ÿå°±æ˜¯è¯´å°†æ¯å°node,çš„ens36æ”¹æˆå¯¹åº”çš„IPæ”¹æˆ`192.168.254.*`ç½‘æ®µ







###### è¯†åˆ«ç½‘å¡å

```bash
[root@node3 ~]# ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 00:0c:29:c8:0f:b0 brd ff:ff:ff:ff:ff:ff
    inet 192.168.168.195/24 brd 192.168.168.255 scope global noprefixroute dynamic ens33
       valid_lft 1103sec preferred_lft 1103sec
    inet6 2408:840d:3a00:2cfe:cf03:7e17:f65:a2b7/64 scope global noprefixroute 
       valid_lft forever preferred_lft forever
    inet6 2408:840d:3400:857:284d:5cd1:34ca:106b/64 scope global noprefixroute 
       valid_lft forever preferred_lft forever
    inet6 fe80::c33d:734d:99d7:b1f/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever
3: ens36: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 00:0c:29:c8:0f:ba brd ff:ff:ff:ff:ff:ff
    inet 192.168.56.103/24 brd 192.168.56.255 scope global noprefixroute ens36
       valid_lft forever preferred_lft forever
    inet6 fe80::20c:29ff:fec8:fba/64 scope link 
       valid_lft forever preferred_lft forever
4: virbr0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state DOWN group default qlen 1000
    link/ether 52:54:00:23:87:ad brd ff:ff:ff:ff:ff:ff
    inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0
       valid_lft forever preferred_lft forever
5: virbr0-nic: <BROADCAST,MULTICAST> mtu 1500 qdisc pfifo_fast master virbr0 state DOWN group default qlen 1000
    link/ether 52:54:00:23:87:ad brd ff:ff:ff:ff:ff:ff
```

è¯´æ˜ï¼šens33æ˜¯æ¡¥æ¥ï¼Œens36æ˜¯å›ºå®šï¼





##### æ–°å¢ens36é…ç½®(ä¸åŒnodeIPåç¼€æ•°å­—ä¸ä¸€æ ·)

>ä¸ºäº†é¿å… DHCP æ”¹åŠ¨ IPï¼Œå»ºè®®ç›´æ¥é…ç½®é™æ€ IP

```bash
vim /etc/sysconfig/network-scripts/ifcfg-ens36
```



>æ–°å¢å¦‚ä¸‹å†…å®¹

```bash
TYPE=Ethernet
BOOTPROTO=static
NAME=ens36
DEVICE=ens36
ONBOOT=yes
IPADDR=192.168.56.103
NETMASK=255.255.255.0
```

æ³¨ï¼šIPADDR=192.168.56.103å…¶å®æ˜¯node3ï¼Œé‚£ä¹ˆnode2åˆ™æ˜¯IPADDR=192.168.56.102ï¼Œä¾æ¬¡ç±»æ¨







###### node1

```bash
TYPE=Ethernet
BOOTPROTO=static
NAME=ens36
DEVICE=ens36
ONBOOT=yes
IPADDR=192.168.254.2
NETMASK=255.255.255.0
```



###### node2

```bash
TYPE=Ethernet
BOOTPROTO=static
NAME=ens36
DEVICE=ens36
ONBOOT=yes
IPADDR=192.168.254.3
NETMASK=255.255.255.0
```





###### node3

```bash
TYPE=Ethernet
BOOTPROTO=static
NAME=ens36
DEVICE=ens36
ONBOOT=yes
IPADDR=192.168.254.4
NETMASK=255.255.255.0
```









##### é…ç½®äº’è”IP

>åœ¨æ¯å°nodeä¸Šå‡æ‰§è¡Œ

```java
cat > /etc/hosts <<EOF
127.0.0.1   localhost
192.168.254.2 node1
192.168.254.3 node2
192.168.254.4 node3
EOF
```





ä¿å­˜åï¼š

```
systemctl restart network
```





##### éªŒè¯

###### éªŒè¯ä¸åŒwifiä¸‹æ˜¯å¦ç”¨xshellè¾“å…¥å›ºå®šIPè¿˜æ˜¯èƒ½è¿æ¥

æµ‹è¯•æˆåŠŸ



###### éªŒè¯å…¶å®ƒnodeäº’è”

```bash
ping node1
ping node2
ping node3
```



```bash
[root@node1 ~]# ping node1
PING node1 (192.168.56.101) 56(84) bytes of data.
64 bytes from node1 (192.168.56.101): icmp_seq=1 ttl=64 time=0.040 ms
pin64 bytes from node1 (192.168.56.101): icmp_seq=2 ttl=64 time=0.058 ms
g^H^C
--- node1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 999ms
rtt min/avg/max/mdev = 0.040/0.049/0.058/0.009 ms
[root@node1 ~]# ping node2
PING node2 (192.168.56.102) 56(84) bytes of data.
64 bytes from node2 (192.168.56.102): icmp_seq=1 ttl=64 time=0.564 ms
64 bytes from node2 (192.168.56.102): icmp_seq=2 ttl=64 time=1.35 ms
^C
--- node2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1000ms
rtt min/avg/max/mdev = 0.564/0.961/1.358/0.397 ms
[root@node1 ~]# ping node3
PING node3 (192.168.56.103) 56(84) bytes of data.
64 bytes from node3 (192.168.56.103): icmp_seq=1 ttl=64 time=0.600 ms
64 bytes from node3 (192.168.56.103): icmp_seq=2 ttl=64 time=1.37 ms
```





###### éªŒè¯æˆåŠŸæ ‡å¿—

åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šæ‰§è¡Œï¼š

```
hostname -I
```

å¦‚æœä¸‰å°è™šæ‹Ÿæœºåˆ†åˆ«è¿”å›å¯¹åº”IP

è¯´æ˜ IP ä¸å†²çªï¼Œå¯ä»¥æ­ Kafka é›†ç¾¤äº†ã€‚





##### é‡åˆ°çš„é—®é¢˜



###### çº¿ä¸Šç¯å¢ƒï¼šå¤šå° VM çš„ ens36 ç½‘ç»œé—®é¢˜æ€»ç»“

> é—®é¢˜æ¦‚è¦

\- ç›®æ ‡ï¼šä¸‰å° VM çš„æ¥å£ ens36 åˆ†åˆ«åœ¨å®¿ä¸»æœºçš„ Hostâ€‘only ç½‘æ®µ 192.168.254.0/24 ä¸Šï¼Œå®¿ä¸»æœºçš„ VMnet åœ°å€ä¸º 192.168.254.1ï¼Œä¸‰å° VM çš„æœŸæœ›åœ°å€ä¸º 192.168.254.2/3/4ã€‚

\- å®é™…æƒ…å†µï¼šåœ¨ node2 ä¸Šé€šè¿‡ `ip -br addr` æŸ¥çœ‹åˆ° ens36 çš„åœ°å€æ˜¯ 192.168.56.102/24ï¼Œè€Œå®¿ä¸»æœºçš„ virbr0 æ¥å£æ˜¾ç¤º 192.168.122.1 çš„åœ°å€ï¼ˆlibvirt çš„é»˜è®¤æ¡¥æ¥ç½‘æ®µï¼‰ï¼Œä¸æœŸæœ›çš„ 192.168.254.0/24 ç½‘æ®µæ— å…³ã€‚

\- ç»“è®ºï¼šé—®é¢˜å¹¶éä»…ä»…æ˜¯æœ¬åœ°çš„ ifcfg æ–‡ä»¶æœªè¢«åº”ç”¨ï¼Œè€Œæ˜¯ç½‘ç»œæ‹“æ‰‘è¢«ç»‘å®šåˆ°é”™è¯¯çš„è™šæ‹Ÿç½‘æ®µï¼ˆ192.168.56.0/24ï¼‰ï¼Œä»¥åŠ/æˆ– NetworkManager ä½¿ç”¨äº†ä¸åŒçš„è¿æ¥é…ç½®è¦†ç›–äº†é™æ€é…ç½®ã€‚

> åŸå› åˆ†æ

\- ens36 å®é™…è¿æ¥åˆ°äº†é”™è¯¯çš„è™šæ‹Ÿç½‘æ®µï¼ˆ192.168.56.0/24ï¼‰ï¼Œè€Œä¸æ˜¯å®¿ä¸»æœºçš„ Hostâ€‘only ç½‘æ®µ 192.168.254.0/24ã€‚

\- virbr0ï¼ˆ192.168.122.1ï¼‰æ˜¯ libvirt çš„é»˜è®¤æ¡¥ï¼Œå’Œå½“å‰é—®é¢˜çš„æ¥å£ ens36 æ— ç›´æ¥å…³ç³»ï¼Œä½†å®¹æ˜“é€ æˆæ··æ·†ã€‚

\- å³ä½¿ç¼–è¾‘äº† /etc/sysconfig/network-scripts/ifcfg-ens36ï¼ŒNetworkManager ä»å¯èƒ½é€šè¿‡ç°æœ‰çš„è¿æ¥ä½¿ç”¨ DHCP/å…¶ä»–è‡ªåŠ¨é…ç½®è¦†ç›–é™æ€é…ç½®ã€‚

\- éœ€è¦ï¼šç¡®è®¤å®¿ä¸»æœº VMnet é…ç½®ã€ç¡®ä¿ VM å†… ens36 ç»‘å®šåˆ°æ­£ç¡®çš„ VMnet/ç½‘æ®µã€ä»¥åŠé€šè¿‡é€‚å½“çš„æ–¹å¼ï¼ˆnmcli æˆ– ifcfgï¼‰è®¾ç½®é™æ€ IPï¼Œå¹¶ç¡®ä¿è¯¥è¿æ¥è¢«æ¿€æ´»ã€‚

> è§£å†³æ€è·¯ä¸æ­¥éª¤ï¼ˆå·²å®Œæˆï¼‰

\1. éªŒè¯å½“å‰ç½‘ç»œçŠ¶æ€

   \- ä½¿ç”¨ ip å‘½ä»¤ç¡®è®¤å®é™…åˆ†é…çš„ IPã€æ¥å£åŠç½‘æ®µã€‚

   \- ä½¿ç”¨ nmcli æŸ¥çœ‹ NetworkManager çš„è®¾å¤‡å’Œè¿æ¥ä¿¡æ¯ï¼Œæ‰¾å‡º ens36 å¯¹åº”çš„è¿æ¥åã€‚

\2. å®¿ä¸»æœºå±‚é¢ç¡®è®¤

   \- åœ¨å®¿ä¸»æœº VMware çš„ Virtual Network Editor ä¸­ï¼š

â€‹     \- å°† Hostâ€‘only ç½‘æ®µè®¾ä¸º 192.168.254.0/24ï¼Œå®¿ä¸»æœºåœ°å€ä¸º 192.168.254.1ã€‚

â€‹     \- å…³é—­æˆ–é™åˆ¶ DHCP èŒƒå›´ï¼Œé¿å…è¦†ç›– 192.168.254.2â€“4ã€‚

\3. VM ä¾§çš„ç½‘å¡ç»‘å®š

   \- å°† ens36 ç»‘å®šåˆ°æ–°çš„ Hostâ€‘only VMnetï¼ˆå¦‚ Custom: VMnet1ï¼‰ã€‚

   \- ç¡®è®¤ ens36 çš„ MAC ä¸ VM è®¾ç½®ä¸­çš„ç½‘å¡åŒ¹é…ï¼Œç¡®ä¿ç‰©ç†å±‚é€»è¾‘ç»‘å®šä¸€è‡´ã€‚

\4. ä½¿ç”¨ NetworkManager è®¾ç½®é™æ€ IP

   \- åˆ—å‡ºè¿æ¥å¹¶æ‰¾åˆ° ens36 çš„è¿æ¥åï¼š

â€‹     \- nmcli device status

â€‹     \- nmcli connection show

   \- ä¿®æ”¹ä¸ºé™æ€åœ°å€ï¼ˆä»¥ node2 ä¸ºä¾‹ï¼š192.168.254.3/24ï¼‰å¹¶æ¿€æ´»ï¼š

â€‹     \- nmcli connection modify "<è¿æ¥å_for_ens36>" ipv4.method manual ipv4.addresses 192.168.254.3/24

â€‹     \- nmcli connection up "<è¿æ¥å_for_ens36>"

   \- ä¹Ÿå¯ä»¥æ–°å»ºä¸€ä¸ªç‹¬ç«‹çš„é™æ€è¿æ¥å¹¶å¯ç”¨ï¼Œä»¥ç¡®ä¿ä¸ä¼šè¢« DHCP è¦†ç›–ã€‚

\5. éªŒè¯ä¸è‡ªæ£€

   \- åœ¨ VM å†…æ‰§è¡Œ ip -br addrï¼Œç¡®è®¤ ens36 æ˜¾ç¤º 192.168.254.x/24ã€‚

   \- ä¸å®¿ä¸»æœºåŠå…¶ä»–èŠ‚ç‚¹äº’ç›¸è¿é€šï¼ˆping æµ‹è¯•ï¼‰ã€‚

   \- å¦‚æœ‰æ—§è¿æ¥æŒç»­è¦†ç›–é™æ€é…ç½®ï¼Œç¦ç”¨æˆ–åˆ é™¤åŸæœ‰ DHCP/è‡ªåŠ¨è¿æ¥ã€‚

\6. å¤„ç†å¸¸è§å¡ç‚¹

   \- å¦‚æœ ens36 ä»æ˜¾ç¤º 192.168.56.xï¼Œè¯´æ˜ä»ç»‘å®šåˆ°é”™è¯¯ VMnetï¼Œå›åˆ°æ­¥éª¤ 2 é‡æ–°ç»‘å®šåˆ°æ­£ç¡® VMnetã€‚

   \- virbr0 çš„ 192.168.122.1 å¯ä»¥å¿½ç•¥ï¼Œè‹¥ä¸éœ€è¦ libvirt ç½‘ç»œï¼Œå¯è€ƒè™‘ç¦ç”¨/é”€æ¯é»˜è®¤ç½‘ç»œã€‚

> æœ€ç»ˆçŠ¶æ€

\- ä¸‰å° VM çš„ ens36 å·²ç»‘å®šåˆ°å®¿ä¸»æœºçš„ Hostâ€‘only ç½‘æ®µ 192.168.254.0/24ã€‚

\- ä¸‰å° VM çš„ IP åœ°å€åˆ†é…å¦‚ï¼š192.168.254.2ã€192.168.254.3ã€192.168.254.4ï¼ˆæŒ‰éœ€åˆ†é…ï¼‰ã€‚

\- ç¡®è®¤å®Œæˆåï¼Œä¸‰å° VM ä¹‹é—´å¯äº’ç›¸ Pingï¼Œç›¸é‚»å®¿ä¸»æœºä¹Ÿå¯ Ping é€šã€‚

> å‚è€ƒå‘½ä»¤æ¸…å•

\- æŸ¥çœ‹ç®€è¦æ¥å£ä¸åœ°å€

  \- ip -br addr

  \- ip addr show ens36

\- æŸ¥çœ‹ NetworkManager çŠ¶æ€

  \- nmcli device status

  \- nmcli connection show

  \- nmcli connection up "<è¿æ¥å>"

  \- nmcli connection modify "<è¿æ¥å>" ipv4.method manual ipv4.addresses 192.168.254.x/24

\- æŸ¥çœ‹/ä¿®æ”¹ ifcfg é…ç½®ï¼ˆè‹¥ä»ä½¿ç”¨ï¼‰

  \- cat /etc/sysconfig/network-scripts/ifcfg-ens36

  \- systemctl restart NetworkManager

\- VMware ç½‘è·¯é…ç½®ï¼ˆå®¿ä¸»æœºï¼‰

  \- VMware Virtual Network Editor â†’ VMnet1 â†’ è®¾ç½®ä¸º 192.168.254.0/24ï¼ˆHostâ€‘onlyï¼‰









### è®¾ç½®æ—¶é—´

>ä¸­å›½ä¸Šæµ·æ—¶åŒº

```bash
[root@node1 ~]# sudo timedatectl set-timezone Asia/Shanghai
[root@node1 ~]# sudo timedatectl set-ntp true
[root@node1 ~]# timedatectl
```

```bash
      Local time: Tue 2025-10-07 21:10:12 CST
  Universal time: Tue 2025-10-07 13:10:12 UTC
        RTC time: Tue 2025-10-07 13:10:12
       Time zone: Asia/Shanghai (CST, +0800)
     NTP enabled: yes
NTP synchronized: yes
 RTC in local TZ: no
      DST active: n/a
```













## JDK17

https://blog.csdn.net/LMS2022223000/article/details/149581584



### 1.å…ˆåˆ é™¤æ—§ç‰ˆæœ¬java

>æ‰§è¡Œjava -versionçœ‹çœ‹æœ‰æ²¡æœ‰å·²ç»å®‰è£…çš„æ—§ç‰ˆæœ¬çš„java

```bash
java -version
```



>æœ‰æ—§ç‰ˆæœ¬java,åº”è¯¥æ˜¯yumå®‰è£…çš„ï¼Œé‚£ä¹ˆå°±ç”¨yumçš„å‘½ä»¤æ¥å¸è½½

ä¸€èˆ¬é»˜è®¤åœ¨`/usr/lib/jvm`ç›®å½•ä¸‹çœ‹æœ‰å“ªäº›ç‰ˆæœ¬çš„java



>ä½¿ç”¨yumæ¥åˆ é™¤ï¼Œä¾‹å¦‚å¦‚ä¸‹å‘½ä»¤

```bash
yum remove -y java-1.7.0-openjdk*
```

ç›´åˆ°å…¨éƒ¨åˆ é™¤å®Œæ¯•åï¼Œæ‰§è¡Œ`java`å‘½ä»¤å‘ç°å¹¶æ²¡æœ‰äº†

![image-20251005182328736](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202510051823776.png)



### 2.å°†æŒ‡å®šç‰ˆæœ¬çš„å®‰è£…åŒ…è§£å‹åˆ°ç›¸åº”ç›®å½•ä¸‹

>è§£å‹åˆ°/hli/software/jdk17/ç›®å½•ä¸‹

```bash
tar -xzvf jdk-17.0.15_linux-x64_bin.tar.gz -C /hli/software/jdk17/
```



>å°†æ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹ç§»åŠ¨åˆ°æŒ‡å®š./jdkç›®å½•ä¸‹,å¹¶åˆ é™¤æ—§ç›®å½•

```bash
mv /hli/software/jdk17/jdk-17.0.15/* /hli/software/jdk17/
```



```bash
rm -rf /hli/software/jdk17/jdk-17.0.15/
```



### 3.é…ç½®ç¯å¢ƒéå†

>ä¿®æ”¹`vim /etc/profile`å†…å®¹ï¼Œä»¥æ–°å¢æŒ‡å®šç›®å½•JDKç‰ˆæœ¬ç¯å¢ƒå˜é‡

```bash
export JAVA_HOME=/hli/software/jdk17
export CLASSPATH=.:JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
export PATH=$JAVA_HOME/bin:$PATH
```



>è¦åœ¨æŸä¸ª`fi`ä¸‹æ‰è¡Œ

![image-20251005183626841](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202510051836898.png)



### 4.é‡æ–°åŠ è½½æ–°é…ç½®

>é‡æ–°åŠ è½½ä½¿å…¶ç”Ÿæ•ˆ

```bash
source /etc/profile
```





### 5.æˆåŠŸ

>å·²ç”Ÿæ•ˆ

```bash
[root@localhost jdk17]# java -version
```



```bash
java version "17.0.15" 2025-04-15 LTS
Java(TM) SE Runtime Environment (build 17.0.15+9-LTS-241)
Java HotSpot(TM) 64-Bit Server VM (build 17.0.15+9-LTS-241, mixed mode, sharing)
[root@localhost jdk17]# 
```





## Kafka4.0.0(æ— zookeper)é›†ç¾¤



### 1.è§£å‹ç¼©kafka_2.13-4.0.0.tgz

>è§£å‹ç¼©åˆ°æŒ‡å®šçš„ç›®å½•`/hli/software/kafka4/`ä¸‹

```bash
tar -zxvf /hli/package/kafka_2.13-4.0.0.tgz -C /hli/software/kafka4/
```



>ç§»åŠ¨åˆ°ä¸Šä¸€çº§ç›®å½•

```bash
mv /hli/software/kafka4/kafka_2.13-4.0.0/* /hli/software/kafka4/
```



>åˆ é™¤å†…åµŒåŒ…

```bash
rm -rf /hli/software/kafka4/kafka_2.13-4.0.0/
```





### 2.ä¿®æ”¹server.properties



#### å®Œæ•´é…ç½®æ–‡ä»¶

```java
############################# æœåŠ¡å™¨åŸºç¡€é…ç½® #############################

# æ­¤æœåŠ¡å™¨çš„è§’è‰²ã€‚è®¾ç½®æ­¤é¡¹è¡¨ç¤ºè¿è¡Œåœ¨ KRaft æ¨¡å¼
process.roles=broker,controller

# æ­¤èŠ‚ç‚¹çš„å”¯ä¸€ IDï¼ˆæ¯ä¸ªèŠ‚ç‚¹å¿…é¡»ä¸åŒï¼‰
node.id=1

# æ§åˆ¶å™¨é›†ç¾¤çš„å¼•å¯¼åœ°å€ï¼Œç”¨äºè¿æ¥æ§åˆ¶å™¨é›†ç¾¤
controller.quorum.bootstrap.servers=localhost:9093

############################# Socket æœåŠ¡å™¨è®¾ç½® #############################

# Socket æœåŠ¡å™¨ç›‘å¬çš„åœ°å€
# å½“èŠ‚ç‚¹åŒæ—¶æ‰¿æ‹… broker å’Œ controller æ—¶ï¼Œå¿…é¡»è‡³å°‘åˆ—å‡º controller listener
# å¦‚æœæœªå®šä¹‰ broker listenerï¼Œé»˜è®¤ä¼šä½¿ç”¨ java.net.InetAddress.getCanonicalHostName() ä½œä¸ºä¸»æœºåï¼Œ
# ä½¿ç”¨ PLAINTEXT åè®®ï¼Œç«¯å£ä¸º 9092ã€‚
# æ ¼å¼ï¼š
#   listeners = listener_name://host_name:port
# ç¤ºä¾‹ï¼š
#   listeners = PLAINTEXT://your.host.name:9092
listeners=PLAINTEXT://:9092,CONTROLLER://:9093

# ç”¨äº broker ä¹‹é—´é€šä¿¡çš„ listener åç§°
inter.broker.listener.name=PLAINTEXT

# broker æˆ– controller å‘å®¢æˆ·ç«¯å®£ä¼ çš„ listener åç§°ã€ä¸»æœºåå’Œç«¯å£
# å¦‚æœæœªè®¾ç½®ï¼Œåˆ™ä½¿ç”¨ "listeners" çš„å€¼
advertised.listeners=PLAINTEXT://localhost:9092,CONTROLLER://localhost:9093

# controller ä½¿ç”¨çš„ listener åç§°åˆ—è¡¨
# åœ¨ KRaft æ¨¡å¼ä¸‹å¿…é¡»é…ç½®
controller.listener.names=CONTROLLER

# å°† listener åç§°æ˜ å°„ä¸ºå®‰å…¨åè®®ï¼Œé»˜è®¤åç§°ä¸åè®®ç›¸åŒ
listener.security.protocol.map=CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT,SSL:SSL,SASL_PLAINTEXT:SASL_PLAINTEXT,SASL_SSL:SASL_SSL

# ç½‘ç»œçº¿ç¨‹æ•°ï¼šç”¨äºæ¥æ”¶ç½‘ç»œè¯·æ±‚å¹¶å‘é€å“åº”
num.network.threads=3

# I/O çº¿ç¨‹æ•°ï¼šç”¨äºå¤„ç†è¯·æ±‚ï¼Œå¯èƒ½åŒ…æ‹¬ç£ç›˜ I/O
num.io.threads=8

# Socket å‘é€ç¼“å†²åŒºå¤§å°ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰
socket.send.buffer.bytes=102400

# Socket æ¥æ”¶ç¼“å†²åŒºå¤§å°ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰
socket.receive.buffer.bytes=102400

# Socket å¯æ¥å—çš„æœ€å¤§è¯·æ±‚å¤§å°ï¼ˆé˜²æ­¢ OOMï¼‰
socket.request.max.bytes=104857600

############################# æ—¥å¿—åŸºç¡€é…ç½® #############################

# Kafka æ—¥å¿—å­˜å‚¨ç›®å½•ï¼Œå¯ä»¥é…ç½®å¤šä¸ªï¼Œä½¿ç”¨é€—å·åˆ†éš”
log.dirs=/tmp/kraft-combined-logs

# é»˜è®¤ topic åˆ†åŒºæ•°
num.partitions=1

# æ¯ä¸ªæ•°æ®ç›®å½•ç”¨äºæ—¥å¿—æ¢å¤å’Œå…³é—­æ—¶åˆ·æ–°çš„çº¿ç¨‹æ•°
num.recovery.threads.per.data.dir=1

############################# å†…éƒ¨ä¸»é¢˜è®¾ç½® #############################

# __consumer_offsetsã€__share_group_state å’Œ __transaction_state å†…éƒ¨ä¸»é¢˜çš„å‰¯æœ¬å› å­
# é™¤éæ˜¯å¼€å‘æµ‹è¯•ç¯å¢ƒï¼Œå¦åˆ™å»ºè®®å‰¯æœ¬å› å­ > 1 ä¿è¯å¯ç”¨æ€§
offsets.topic.replication.factor=1
share.coordinator.state.topic.replication.factor=1
share.coordinator.state.topic.min.isr=1
transaction.state.log.replication.factor=1
transaction.state.log.min.isr=1

############################# æ—¥å¿—åˆ·æ–°ç­–ç•¥ #############################

# æ¶ˆæ¯ä¼šç«‹å³å†™å…¥æ–‡ä»¶ç³»ç»Ÿï¼Œä½†é»˜è®¤æƒ…å†µä¸‹ fsync() æ˜¯æ‡’åŒæ­¥çš„ã€‚
# ä»¥ä¸‹é…ç½®æ§åˆ¶æ•°æ®åˆ·å†™åˆ°ç£ç›˜çš„ç­–ç•¥ã€‚
# ä¸»è¦æƒè¡¡ï¼š
#    1. æŒä¹…æ€§ï¼šæœªåˆ·æ–°çš„æ•°æ®åœ¨æ²¡æœ‰å¤åˆ¶çš„æƒ…å†µä¸‹å¯èƒ½ä¸¢å¤±ã€‚
#    2. å»¶è¿Ÿï¼šåˆ·å†™é—´éš”è¿‡å¤§æ—¶ä¼šå¯¼è‡´å»¶è¿Ÿå³°å€¼ã€‚
#    3. ååé‡ï¼šåˆ·å†™é€šå¸¸æœ€è€—èµ„æºï¼Œé¢‘ç¹åˆ·å†™ä¼šå¯¼è‡´è¿‡å¤šçš„ç£ç›˜å¯»é“ã€‚
# å¯ä»¥å…¨å±€è®¾ç½®æˆ–æŒ‰ topic å•ç‹¬è¦†ç›–ã€‚

# åœ¨å¼ºåˆ¶åˆ·å†™æ•°æ®åˆ°ç£ç›˜ä¹‹å‰å…è®¸çš„æ¶ˆæ¯æ•°é‡
#log.flush.interval.messages=10000

# åœ¨å¼ºåˆ¶åˆ·å†™æ•°æ®ä¹‹å‰æ¶ˆæ¯å¯ä»¥åœ¨æ—¥å¿—ä¸­åœç•™çš„æœ€é•¿æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
#log.flush.interval.ms=1000

############################# æ—¥å¿—ä¿ç•™ç­–ç•¥ #############################

# ä»¥ä¸‹é…ç½®æ§åˆ¶æ—¥å¿—æ®µçš„åˆ é™¤ç­–ç•¥ã€‚
# å¯ä»¥æŒ‰æ—¶é—´æˆ–æ—¥å¿—å¤§å°åˆ é™¤æ®µæ–‡ä»¶ï¼Œæ»¡è¶³ä»»ä¸€æ¡ä»¶å³åˆ é™¤ã€‚
# åˆ é™¤æ€»æ˜¯ä»æ—¥å¿—æœ«å°¾å¼€å§‹ã€‚

# æ—¥å¿—æ–‡ä»¶è¾¾åˆ°è¯¥å¹´é¾„åå¯è¢«åˆ é™¤ï¼ˆå•ä½ï¼šå°æ—¶ï¼‰ï¼Œ168 å°æ—¶ = 7 å¤©
log.retention.hours=168

# åŸºäºå¤§å°çš„æ—¥å¿—ä¿ç•™ç­–ç•¥ï¼Œæ—¥å¿—æ®µå°†è¢«åˆ é™¤ï¼Œé™¤éå‰©ä½™çš„æ—¥å¿—ä½äº log.retention.bytesã€‚
# ä¸ log.retention.hours ç‹¬ç«‹ç”Ÿæ•ˆã€‚
#log.retention.bytes=1073741824

# æ—¥å¿—æ®µçš„æœ€å¤§å¤§å°ï¼Œè¾¾åˆ°è¯¥å¤§å°æ—¶ä¼šç”Ÿæˆæ–°çš„æ—¥å¿—æ®µ
log.segment.bytes=1073741824

# æ£€æŸ¥æ˜¯å¦å¯åˆ é™¤æ—¥å¿—æ®µçš„æ—¶é—´é—´éš”ï¼ˆæ¯«ç§’ï¼‰
log.retention.check.interval.ms=300000
```











#### ä¿®æ”¹å‰å…ˆå¤‡ä»½ï¼Œå…»æˆå¥½ä¹ æƒ¯

```bash
cp -p /hli/software/kafka4/config/server.properties /hli/software/kafka4/config/server.properties_back
```



#### ä¿®æ”¹é…ç½®æ–‡ä»¶

```bash
vim /hli/software/kafka4/config/server.properties
```



#### ä¿®æ”¹å†…å®¹



##### nodeid

>ä¸»èŠ‚ç‚¹,è¿™é‡Œæ˜¯node1ä¸­çš„é…ç½®ã€å¦‚æœæ˜¯node2åˆ™æ˜¯2ä¾æ¬¡ç±»æ¨

```bash
node.id=1
```



##### brokerå¯¹å¤–æš´éœ²çš„IPå’Œç«¯å£

```bash
#brokerå¯¹å¤–æš´éœ²çš„IPå’Œç«¯å£
advertised.listeners=PLAINTEXT://localhost:9092,CONTROLLER://localhost:9093
```



##### è·¯å¾„ï¼ˆèŠ‚ç‚¹é—´å¿…é¡»ä¸ä¸€æ ·ï¼‰

```bash
log.dirs=/hli/software/kafka4/datas
```



##### node1

```bash
############################# åŸºç¡€è®¾ç½® #############################

# ç»Ÿä¸€ node1 ç”Ÿæˆ UUIDï¼ˆKRaft æ¨¡å¼å¯ç•™åœ¨æ–‡ä»¶ä¸­æˆ–åœ¨ format æ—¶ä½¿ç”¨ -t æŒ‡å®šï¼‰
cluster.id=n8vjTMpNSPWbUOrWJNnHJg

# Kafka èŠ‚ç‚¹è§’è‰²ï¼ŒKRaft æ¨¡å¼å¿…é¡»è®¾ç½®
process.roles=broker,controller

# èŠ‚ç‚¹å”¯ä¸€ IDï¼Œæ¯ä¸ªèŠ‚ç‚¹å¿…é¡»å”¯ä¸€
node.id=1

# KRaft Controller quorum æŠ•ç¥¨è€…ï¼ˆæ‰€æœ‰èŠ‚ç‚¹å¿…é¡»ä¸€è‡´ï¼Œä½¿ç”¨ id@host:portï¼‰
controller.quorum.voters=1@192.168.254.2:9093,2@192.168.254.3:9093,3@192.168.254.4:9093

# ã€åˆ é™¤æ­¤è¡Œã€‘controller.quorum.bootstrap.servers ä¸æ˜¯æ ‡å‡†é…ç½®é¡¹ï¼ŒKafka 4.0 ä¸éœ€è¦
# controller.quorum.bootstrap.servers=CONTROLLER://192.168.1.101:9093,CONTROLLER://192.168.1.102:9093,CONTROLLER://192.168.1.103:9093

############################# Listener é…ç½® #############################

# Kafka Broker å’Œ Controller çš„ç›‘å¬åœ°å€ï¼ˆæœ¬æœºåœ°å€ï¼‰
listeners=PLAINTEXT://192.168.254.2:9092,CONTROLLER://192.168.254.2:9093

# Broker ä¹‹é—´é€šä¿¡ä½¿ç”¨çš„ listener
inter.broker.listener.name=PLAINTEXT

# ã€ä¿®æ”¹ã€‘advertised.listeners ä¸åº”åŒ…å« CONTROLLERï¼Œåªç»™å®¢æˆ·ç«¯å’Œ Broker é—´é€šä¿¡ç”¨
advertised.listeners=PLAINTEXT://192.168.254.2:9092

# Controller listener åç§°
controller.listener.names=CONTROLLER

# Listener ä¸å®‰å…¨åè®®æ˜ å°„
listener.security.protocol.map=CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT

############################# ç½‘ç»œè®¾ç½® #############################

# ç”¨äºæ¥æ”¶è¯·æ±‚çš„ç½‘ç»œçº¿ç¨‹æ•°
num.network.threads=3

# ç”¨äºå¤„ç†è¯·æ±‚çš„çº¿ç¨‹æ•°ï¼ŒåŒ…æ‹¬ç£ç›˜ IO
num.io.threads=8

# å‘é€ç¼“å†²åŒºå¤§å°
socket.send.buffer.bytes=102400

# æ¥æ”¶ç¼“å†²åŒºå¤§å°
socket.receive.buffer.bytes=102400

# æœ€å¤§è¯·æ±‚å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼Œç”¨äºé˜²æ­¢ OOM
socket.request.max.bytes=104857600

############################# æ—¥å¿—å­˜å‚¨ #############################

# æ—¥å¿—å­˜å‚¨ç›®å½•ï¼ˆæ¯ä¸ªèŠ‚ç‚¹ä¸åŒç›®å½•ï¼‰
log.dirs=/hli/software/kafka4/datas/kafka-logs-node1

# æ¯ä¸ª Topic é»˜è®¤åˆ†åŒºæ•°
num.partitions=1

# å¯åŠ¨æ¢å¤æ—¶æ¯ä¸ªæ—¥å¿—ç›®å½•ä½¿ç”¨çš„çº¿ç¨‹æ•°
num.recovery.threads.per.data.dir=1

############################# å†…éƒ¨ä¸»é¢˜é…ç½® #############################

# offsets å†…éƒ¨ä¸»é¢˜å‰¯æœ¬å› å­ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®® >= èŠ‚ç‚¹æ•°
offsets.topic.replication.factor=3

# ã€åˆ é™¤ä»¥ä¸‹ä¸¤è¡Œã€‘share.coordinator æ˜¯å®éªŒæ€§åŠŸèƒ½ï¼Œ4.0 æ­£å¼ç‰ˆé€šå¸¸ä¸éœ€è¦
# share.coordinator.state.topic.replication.factor=3
# share.coordinator.state.topic.min.isr=2

# äº‹åŠ¡çŠ¶æ€ä¸»é¢˜å‰¯æœ¬å› å­
transaction.state.log.replication.factor=3
transaction.state.log.min.isr=2

############################# æ—¥å¿—åˆ·æ–°ç­–ç•¥ #############################

# æ¶ˆæ¯åˆ·ç›˜ç­–ç•¥ï¼ˆå¯æ ¹æ®éœ€æ±‚è°ƒæ•´ï¼‰
#log.flush.interval.messages=10000
#log.flush.interval.ms=1000

############################# æ—¥å¿—ä¿ç•™ç­–ç•¥ #############################

# æ—¥å¿—ä¿ç•™æ—¶é—´ï¼ˆå°æ—¶ï¼‰
log.retention.hours=168

# å•ä¸ªæ—¥å¿—åˆ†æ®µæ–‡ä»¶æœ€å¤§å¤§å°
log.segment.bytes=1073741824

# æ—¥å¿—æ£€æŸ¥åˆ é™¤é—´éš”
log.retention.check.interval.ms=300000

# æ—¥å¿—ä¿ç•™æ€»å¤§å°é™åˆ¶ï¼ˆå¯é€‰é…ç½®ï¼‰
#log.retention.bytes=10737418240

############################# å…¶å®ƒ #############################

# è‡ªåŠ¨åˆ›å»º topic
auto.create.topics.enable=true

# æ˜¯å¦å…è®¸ broker åˆ é™¤ topic
delete.topic.enable=true

# ã€åˆ é™¤æ­¤è¡Œã€‘log4j é…ç½®åº”åœ¨ log4j.properties ä¸­ç®¡ç†ï¼Œä¸å±äº server.properties
# log4j.rootLogger=INFO, stdout
```











##### node2

```bash
############################# åŸºç¡€è®¾ç½® #############################

# Kafka é›†ç¾¤çš„å…¨å±€å”¯ä¸€ IDï¼ˆæ‰€æœ‰èŠ‚ç‚¹å¿…é¡»ä½¿ç”¨ç›¸åŒçš„ cluster.idï¼‰
# è¿™ä¸ª UUID æ˜¯åœ¨ node1 ä¸Šç”Ÿæˆçš„ï¼Œä¸‰ä¸ªèŠ‚ç‚¹å¿…é¡»ä¿æŒä¸€è‡´
cluster.id=n8vjTMpNSPWbUOrWJNnHJg

# Kafka èŠ‚ç‚¹è§’è‰²ï¼ŒKRaft æ¨¡å¼å¿…é¡»è®¾ç½®
# broker: å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚å’Œæ•°æ®å­˜å‚¨
# controller: è´Ÿè´£é›†ç¾¤å…ƒæ•°æ®ç®¡ç†ï¼ˆæ›¿ä»£ ZooKeeperï¼‰
process.roles=broker,controller

# èŠ‚ç‚¹å”¯ä¸€ IDï¼Œé›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹å¿…é¡»å”¯ä¸€
# node1=1, node2=2, node3=3
node.id=2

# KRaft Controller ä»²è£æŠ•ç¥¨è€…é…ç½®
# æ ¼å¼ï¼šnode_id@host:controller_port
# æ‰€æœ‰èŠ‚ç‚¹çš„æ­¤é…ç½®å¿…é¡»å®Œå…¨ä¸€è‡´ï¼Œç”¨äº Controller é€‰ä¸¾å’Œå…ƒæ•°æ®åŒæ­¥
controller.quorum.voters=1@192.168.254.2:9093,2@192.168.254.3:9093,3@192.168.254.4:9093

############################# Listener é…ç½® #############################

# Kafka çš„ç›‘å¬åœ°å€é…ç½®
# PLAINTEXT://ip:port - Broker ç›‘å¬åœ°å€ï¼Œç”¨äºå®¢æˆ·ç«¯è¿æ¥å’Œ Broker é—´é€šä¿¡
# CONTROLLER://ip:port - Controller ç›‘å¬åœ°å€ï¼Œç”¨äº Controller ä»²è£é€šä¿¡
# æ³¨æ„ï¼šè¿™é‡Œä½¿ç”¨æœ¬æœº IP 192.168.254.3
listeners=PLAINTEXT://192.168.254.3:9092,CONTROLLER://192.168.254.3:9093

# Broker ä¹‹é—´é€šä¿¡ä½¿ç”¨çš„ listener åç§°
# ä¸ listeners ä¸­çš„ PLAINTEXT å¯¹åº”
inter.broker.listener.name=PLAINTEXT

# å¹¿æ’­ç»™å®¢æˆ·ç«¯çš„åœ°å€ï¼ˆå®¢æˆ·ç«¯å®é™…è¿æ¥çš„åœ°å€ï¼‰
# åªåŒ…å« PLAINTEXTï¼Œä¸åŒ…å« CONTROLLERï¼ˆController ä¸å¯¹å¤–æš´éœ²ï¼‰
advertised.listeners=PLAINTEXT://192.168.254.3:9092

# Controller ä½¿ç”¨çš„ listener åç§°
# ä¸ listeners ä¸­çš„ CONTROLLER å¯¹åº”
controller.listener.names=CONTROLLER

# Listener åç§°ä¸å®‰å…¨åè®®çš„æ˜ å°„å…³ç³»
# CONTROLLER å’Œ PLAINTEXT éƒ½ä½¿ç”¨æ˜æ–‡é€šä¿¡ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ SSLï¼‰
listener.security.protocol.map=CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT

############################# ç½‘ç»œè®¾ç½® #############################

# ç½‘ç»œå¤„ç†çº¿ç¨‹æ•°
# ç”¨äºæ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚å’Œå‘é€å“åº”ï¼Œå»ºè®®è®¾ç½®ä¸º CPU æ ¸å¿ƒæ•°
num.network.threads=3

# IO å¤„ç†çº¿ç¨‹æ•°
# ç”¨äºå¤„ç†è¯·æ±‚é€»è¾‘ï¼ŒåŒ…æ‹¬ç£ç›˜è¯»å†™ï¼Œå»ºè®®è®¾ç½®ä¸º CPU æ ¸å¿ƒæ•°çš„ 2 å€
num.io.threads=8

# Socket å‘é€ç¼“å†²åŒºå¤§å°ï¼ˆå­—èŠ‚ï¼‰
# å½±å“ç½‘ç»œååé‡ï¼Œé»˜è®¤ 100KB
socket.send.buffer.bytes=102400

# Socket æ¥æ”¶ç¼“å†²åŒºå¤§å°ï¼ˆå­—èŠ‚ï¼‰
# å½±å“ç½‘ç»œååé‡ï¼Œé»˜è®¤ 100KB
socket.receive.buffer.bytes=102400

# å•ä¸ªè¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°ï¼ˆ100MBï¼‰
# ç”¨äºé˜²æ­¢å†…å­˜æº¢å‡ºï¼ˆOOMï¼‰ï¼Œéœ€è¦æ ¹æ®æ¶ˆæ¯å¤§å°è°ƒæ•´
socket.request.max.bytes=104857600

############################# æ—¥å¿—å­˜å‚¨ #############################

# Kafka æ•°æ®å­˜å‚¨ç›®å½•ï¼ˆæ—¥å¿—åˆ†æ®µæ–‡ä»¶å­˜å‚¨ä½ç½®ï¼‰
# æ¯ä¸ªèŠ‚ç‚¹ä½¿ç”¨ä¸åŒçš„ç›®å½•ï¼Œé¿å…æ•°æ®å†²çª
# node1: kafka-logs-node1, node2: kafka-logs-node2, node3: kafka-logs-node3
log.dirs=/hli/software/kafka4/datas/kafka-logs-node2

# æ–°åˆ›å»º Topic æ—¶çš„é»˜è®¤åˆ†åŒºæ•°
# åˆ†åŒºæ•°è¶Šå¤šï¼Œå¹¶è¡Œåº¦è¶Šé«˜ï¼Œä½†ä¹Ÿä¼šå¢åŠ èµ„æºæ¶ˆè€—
num.partitions=1

# å¯åŠ¨æ—¶æ—¥å¿—æ¢å¤å’Œå…³é—­æ—¶åˆ·ç›˜ä½¿ç”¨çš„çº¿ç¨‹æ•°ï¼ˆæ¯ä¸ªæ•°æ®ç›®å½•ï¼‰
# å¦‚æœä½¿ç”¨ RAID é˜µåˆ—ï¼Œå»ºè®®å¢åŠ æ­¤å€¼
num.recovery.threads.per.data.dir=1

############################# å†…éƒ¨ä¸»é¢˜é…ç½® #############################

# __consumer_offsets ä¸»é¢˜çš„å‰¯æœ¬å› å­
# ç”¨äºå­˜å‚¨æ¶ˆè´¹è€…ç»„çš„ä½ç§»ä¿¡æ¯ï¼Œå»ºè®®è®¾ç½®ä¸ºé›†ç¾¤èŠ‚ç‚¹æ•°ï¼ˆ3ï¼‰
offsets.topic.replication.factor=3

# __transaction_state ä¸»é¢˜çš„å‰¯æœ¬å› å­
# ç”¨äºå­˜å‚¨äº‹åŠ¡çŠ¶æ€ä¿¡æ¯ï¼Œå»ºè®®è®¾ç½®ä¸ºé›†ç¾¤èŠ‚ç‚¹æ•°ï¼ˆ3ï¼‰
transaction.state.log.replication.factor=3

# __transaction_state ä¸»é¢˜çš„æœ€å°åŒæ­¥å‰¯æœ¬æ•°
# è‡³å°‘éœ€è¦ 2 ä¸ªå‰¯æœ¬åŒæ­¥æˆåŠŸæ‰è®¤ä¸ºå†™å…¥æˆåŠŸï¼Œä¿è¯æ•°æ®å¯é æ€§
transaction.state.log.min.isr=2

############################# æ—¥å¿—åˆ·æ–°ç­–ç•¥ #############################

# Kafka é»˜è®¤å¼‚æ­¥åˆ·ç›˜ï¼ˆå†™å…¥æ“ä½œç³»ç»Ÿç¼“å­˜ï¼‰ï¼Œä»¥ä¸‹é…ç½®å¯å¼ºåˆ¶åŒæ­¥åˆ·ç›˜
# æ³¨æ„ï¼šåŒæ­¥åˆ·ç›˜ä¼šæ˜¾è‘—é™ä½æ€§èƒ½ï¼Œå»ºè®®ä¾èµ–å‰¯æœ¬æœºåˆ¶ä¿è¯æ•°æ®å¯é æ€§

# æ¯æ¥æ”¶å¤šå°‘æ¡æ¶ˆæ¯å¼ºåˆ¶åˆ·ç›˜ä¸€æ¬¡ï¼ˆæ³¨é‡Šè¡¨ç¤ºä¸å¯ç”¨ï¼‰
#log.flush.interval.messages=10000

# æ¯éš”å¤šå°‘æ¯«ç§’å¼ºåˆ¶åˆ·ç›˜ä¸€æ¬¡ï¼ˆæ³¨é‡Šè¡¨ç¤ºä¸å¯ç”¨ï¼‰
#log.flush.interval.ms=1000

############################# æ—¥å¿—ä¿ç•™ç­–ç•¥ #############################

# æ—¥å¿—ä¿ç•™æ—¶é—´ï¼ˆå°æ—¶ï¼‰
# è¶…è¿‡æ­¤æ—¶é—´çš„æ—¥å¿—åˆ†æ®µæ–‡ä»¶å°†è¢«åˆ é™¤ï¼Œé»˜è®¤ 7 å¤©ï¼ˆ168 å°æ—¶ï¼‰
log.retention.hours=168

# å•ä¸ªæ—¥å¿—åˆ†æ®µæ–‡ä»¶çš„æœ€å¤§å¤§å°ï¼ˆ1GBï¼‰
# è¾¾åˆ°æ­¤å¤§å°åå°†åˆ›å»ºæ–°çš„æ—¥å¿—åˆ†æ®µæ–‡ä»¶
log.segment.bytes=1073741824

# æ—¥å¿—æ¸…ç†æ£€æŸ¥é—´éš”ï¼ˆæ¯«ç§’ï¼‰
# æ¯éš” 5 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ˜¯å¦æœ‰æ—¥å¿—éœ€è¦åˆ é™¤
log.retention.check.interval.ms=300000

# æ—¥å¿—ä¿ç•™çš„æœ€å¤§æ€»å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼Œå¯é€‰é…ç½®
# è¶…è¿‡æ­¤å¤§å°åï¼Œæœ€æ—§çš„æ—¥å¿—åˆ†æ®µå°†è¢«åˆ é™¤
# æ³¨é‡Šè¡¨ç¤ºä¸é™åˆ¶æ€»å¤§å°ï¼Œåªæ ¹æ®æ—¶é—´åˆ é™¤
#log.retention.bytes=10737418240

############################# å…¶å®ƒé…ç½® #############################

# æ˜¯å¦å…è®¸è‡ªåŠ¨åˆ›å»º Topic
# true: ç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…è®¿é—®ä¸å­˜åœ¨çš„ Topic æ—¶è‡ªåŠ¨åˆ›å»º
# false: å¿…é¡»æ‰‹åŠ¨åˆ›å»º Topicï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®è®¾ç½®ä¸º falseï¼‰
auto.create.topics.enable=true

# æ˜¯å¦å…è®¸åˆ é™¤ Topic
# true: å¯ä»¥é€šè¿‡å‘½ä»¤åˆ é™¤ Topic
# false: åˆ é™¤å‘½ä»¤æ— æ•ˆï¼ˆKafka 4.0 é»˜è®¤ä¸º trueï¼‰
delete.topic.enable=true
```





##### node3

```bash
############################# åŸºç¡€è®¾ç½® #############################

# Kafka é›†ç¾¤çš„å…¨å±€å”¯ä¸€ IDï¼ˆæ‰€æœ‰èŠ‚ç‚¹å¿…é¡»ä½¿ç”¨ç›¸åŒçš„ cluster.idï¼‰
# è¿™ä¸ª UUID æ˜¯åœ¨ node1 ä¸Šç”Ÿæˆçš„ï¼Œä¸‰ä¸ªèŠ‚ç‚¹å¿…é¡»ä¿æŒä¸€è‡´
cluster.id=n8vjTMpNSPWbUOrWJNnHJg

# Kafka èŠ‚ç‚¹è§’è‰²ï¼ŒKRaft æ¨¡å¼å¿…é¡»è®¾ç½®
# broker: å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚å’Œæ•°æ®å­˜å‚¨
# controller: è´Ÿè´£é›†ç¾¤å…ƒæ•°æ®ç®¡ç†ï¼ˆæ›¿ä»£ ZooKeeperï¼‰
process.roles=broker,controller

# èŠ‚ç‚¹å”¯ä¸€ IDï¼Œé›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹å¿…é¡»å”¯ä¸€
# node1=1, node2=2, node3=3
node.id=3

# KRaft Controller ä»²è£æŠ•ç¥¨è€…é…ç½®
# æ ¼å¼ï¼šnode_id@host:controller_port
# æ‰€æœ‰èŠ‚ç‚¹çš„æ­¤é…ç½®å¿…é¡»å®Œå…¨ä¸€è‡´ï¼Œç”¨äº Controller é€‰ä¸¾å’Œå…ƒæ•°æ®åŒæ­¥
controller.quorum.voters=1@192.168.254.2:9093,2@192.168.254.3:9093,3@192.168.254.4:9093

############################# Listener é…ç½® #############################

# Kafka çš„ç›‘å¬åœ°å€é…ç½®
# PLAINTEXT://ip:port - Broker ç›‘å¬åœ°å€ï¼Œç”¨äºå®¢æˆ·ç«¯è¿æ¥å’Œ Broker é—´é€šä¿¡
# CONTROLLER://ip:port - Controller ç›‘å¬åœ°å€ï¼Œç”¨äº Controller ä»²è£é€šä¿¡
# æ³¨æ„ï¼šè¿™é‡Œä½¿ç”¨æœ¬æœº IP 192.168.56.103
listeners=PLAINTEXT://192.168.254.4:9092,CONTROLLER://192.168.254.4:9093

# Broker ä¹‹é—´é€šä¿¡ä½¿ç”¨çš„ listener åç§°
# ä¸ listeners ä¸­çš„ PLAINTEXT å¯¹åº”
inter.broker.listener.name=PLAINTEXT

# å¹¿æ’­ç»™å®¢æˆ·ç«¯çš„åœ°å€ï¼ˆå®¢æˆ·ç«¯å®é™…è¿æ¥çš„åœ°å€ï¼‰
# åªåŒ…å« PLAINTEXTï¼Œä¸åŒ…å« CONTROLLERï¼ˆController ä¸å¯¹å¤–æš´éœ²ï¼‰
advertised.listeners=PLAINTEXT://192.168.254.4:9092

# Controller ä½¿ç”¨çš„ listener åç§°
# ä¸ listeners ä¸­çš„ CONTROLLER å¯¹åº”
controller.listener.names=CONTROLLER

# Listener åç§°ä¸å®‰å…¨åè®®çš„æ˜ å°„å…³ç³»
# CONTROLLER å’Œ PLAINTEXT éƒ½ä½¿ç”¨æ˜æ–‡é€šä¿¡ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ SSLï¼‰
listener.security.protocol.map=CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT

############################# ç½‘ç»œè®¾ç½® #############################

# ç½‘ç»œå¤„ç†çº¿ç¨‹æ•°
# ç”¨äºæ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚å’Œå‘é€å“åº”ï¼Œå»ºè®®è®¾ç½®ä¸º CPU æ ¸å¿ƒæ•°
num.network.threads=3

# IO å¤„ç†çº¿ç¨‹æ•°
# ç”¨äºå¤„ç†è¯·æ±‚é€»è¾‘ï¼ŒåŒ…æ‹¬ç£ç›˜è¯»å†™ï¼Œå»ºè®®è®¾ç½®ä¸º CPU æ ¸å¿ƒæ•°çš„ 2 å€
num.io.threads=8

# Socket å‘é€ç¼“å†²åŒºå¤§å°ï¼ˆå­—èŠ‚ï¼‰
# å½±å“ç½‘ç»œååé‡ï¼Œé»˜è®¤ 100KB
socket.send.buffer.bytes=102400

# Socket æ¥æ”¶ç¼“å†²åŒºå¤§å°ï¼ˆå­—èŠ‚ï¼‰
# å½±å“ç½‘ç»œååé‡ï¼Œé»˜è®¤ 100KB
socket.receive.buffer.bytes=102400

# å•ä¸ªè¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°ï¼ˆ100MBï¼‰
# ç”¨äºé˜²æ­¢å†…å­˜æº¢å‡ºï¼ˆOOMï¼‰ï¼Œéœ€è¦æ ¹æ®æ¶ˆæ¯å¤§å°è°ƒæ•´
socket.request.max.bytes=104857600

############################# æ—¥å¿—å­˜å‚¨ #############################

# Kafka æ•°æ®å­˜å‚¨ç›®å½•ï¼ˆæ—¥å¿—åˆ†æ®µæ–‡ä»¶å­˜å‚¨ä½ç½®ï¼‰
# æ¯ä¸ªèŠ‚ç‚¹ä½¿ç”¨ä¸åŒçš„ç›®å½•ï¼Œé¿å…æ•°æ®å†²çª
# node1: kafka-logs-node1, node2: kafka-logs-node2, node3: kafka-logs-node3
log.dirs=/hli/software/kafka4/datas/kafka-logs-node3

# æ–°åˆ›å»º Topic æ—¶çš„é»˜è®¤åˆ†åŒºæ•°
# åˆ†åŒºæ•°è¶Šå¤šï¼Œå¹¶è¡Œåº¦è¶Šé«˜ï¼Œä½†ä¹Ÿä¼šå¢åŠ èµ„æºæ¶ˆè€—
num.partitions=1

# å¯åŠ¨æ—¶æ—¥å¿—æ¢å¤å’Œå…³é—­æ—¶åˆ·ç›˜ä½¿ç”¨çš„çº¿ç¨‹æ•°ï¼ˆæ¯ä¸ªæ•°æ®ç›®å½•ï¼‰
# å¦‚æœä½¿ç”¨ RAID é˜µåˆ—ï¼Œå»ºè®®å¢åŠ æ­¤å€¼
num.recovery.threads.per.data.dir=1

############################# å†…éƒ¨ä¸»é¢˜é…ç½® #############################

# __consumer_offsets ä¸»é¢˜çš„å‰¯æœ¬å› å­
# ç”¨äºå­˜å‚¨æ¶ˆè´¹è€…ç»„çš„ä½ç§»ä¿¡æ¯ï¼Œå»ºè®®è®¾ç½®ä¸ºé›†ç¾¤èŠ‚ç‚¹æ•°ï¼ˆ3ï¼‰
offsets.topic.replication.factor=3

# __transaction_state ä¸»é¢˜çš„å‰¯æœ¬å› å­
# ç”¨äºå­˜å‚¨äº‹åŠ¡çŠ¶æ€ä¿¡æ¯ï¼Œå»ºè®®è®¾ç½®ä¸ºé›†ç¾¤èŠ‚ç‚¹æ•°ï¼ˆ3ï¼‰
transaction.state.log.replication.factor=3

# __transaction_state ä¸»é¢˜çš„æœ€å°åŒæ­¥å‰¯æœ¬æ•°
# è‡³å°‘éœ€è¦ 2 ä¸ªå‰¯æœ¬åŒæ­¥æˆåŠŸæ‰è®¤ä¸ºå†™å…¥æˆåŠŸï¼Œä¿è¯æ•°æ®å¯é æ€§
transaction.state.log.min.isr=2

############################# æ—¥å¿—åˆ·æ–°ç­–ç•¥ #############################

# Kafka é»˜è®¤å¼‚æ­¥åˆ·ç›˜ï¼ˆå†™å…¥æ“ä½œç³»ç»Ÿç¼“å­˜ï¼‰ï¼Œä»¥ä¸‹é…ç½®å¯å¼ºåˆ¶åŒæ­¥åˆ·ç›˜
# æ³¨æ„ï¼šåŒæ­¥åˆ·ç›˜ä¼šæ˜¾è‘—é™ä½æ€§èƒ½ï¼Œå»ºè®®ä¾èµ–å‰¯æœ¬æœºåˆ¶ä¿è¯æ•°æ®å¯é æ€§

# æ¯æ¥æ”¶å¤šå°‘æ¡æ¶ˆæ¯å¼ºåˆ¶åˆ·ç›˜ä¸€æ¬¡ï¼ˆæ³¨é‡Šè¡¨ç¤ºä¸å¯ç”¨ï¼‰
#log.flush.interval.messages=10000

# æ¯éš”å¤šå°‘æ¯«ç§’å¼ºåˆ¶åˆ·ç›˜ä¸€æ¬¡ï¼ˆæ³¨é‡Šè¡¨ç¤ºä¸å¯ç”¨ï¼‰
#log.flush.interval.ms=1000

############################# æ—¥å¿—ä¿ç•™ç­–ç•¥ #############################

# æ—¥å¿—ä¿ç•™æ—¶é—´ï¼ˆå°æ—¶ï¼‰
# è¶…è¿‡æ­¤æ—¶é—´çš„æ—¥å¿—åˆ†æ®µæ–‡ä»¶å°†è¢«åˆ é™¤ï¼Œé»˜è®¤ 7 å¤©ï¼ˆ168 å°æ—¶ï¼‰
log.retention.hours=168

# å•ä¸ªæ—¥å¿—åˆ†æ®µæ–‡ä»¶çš„æœ€å¤§å¤§å°ï¼ˆ1GBï¼‰
# è¾¾åˆ°æ­¤å¤§å°åå°†åˆ›å»ºæ–°çš„æ—¥å¿—åˆ†æ®µæ–‡ä»¶
log.segment.bytes=1073741824

# æ—¥å¿—æ¸…ç†æ£€æŸ¥é—´éš”ï¼ˆæ¯«ç§’ï¼‰
# æ¯éš” 5 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ˜¯å¦æœ‰æ—¥å¿—éœ€è¦åˆ é™¤
log.retention.check.interval.ms=300000

# æ—¥å¿—ä¿ç•™çš„æœ€å¤§æ€»å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼Œå¯é€‰é…ç½®
# è¶…è¿‡æ­¤å¤§å°åï¼Œæœ€æ—§çš„æ—¥å¿—åˆ†æ®µå°†è¢«åˆ é™¤
# æ³¨é‡Šè¡¨ç¤ºä¸é™åˆ¶æ€»å¤§å°ï¼Œåªæ ¹æ®æ—¶é—´åˆ é™¤
#log.retention.bytes=10737418240

############################# å…¶å®ƒé…ç½® #############################

# æ˜¯å¦å…è®¸è‡ªåŠ¨åˆ›å»º Topic
# true: ç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…è®¿é—®ä¸å­˜åœ¨çš„ Topic æ—¶è‡ªåŠ¨åˆ›å»º
# false: å¿…é¡»æ‰‹åŠ¨åˆ›å»º Topicï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®è®¾ç½®ä¸º falseï¼‰
auto.create.topics.enable=true

# æ˜¯å¦å…è®¸åˆ é™¤ Topic
# true: å¯ä»¥é€šè¿‡å‘½ä»¤åˆ é™¤ Topic
# false: åˆ é™¤å‘½ä»¤æ— æ•ˆï¼ˆKafka 4.0 é»˜è®¤ä¸º trueï¼‰
delete.topic.enable=true

```





### 3.å¼€æ”¾9092,9093ç«¯å£



å‡è®¾ä½ ç”¨çš„æ˜¯ **CentOS/RedHat Linux**ï¼Œä½¿ç”¨ `firewalld` ç®¡ç†é˜²ç«å¢™ã€‚

#### æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€

```
sudo firewall-cmd --state
```

#### æ”¾è¡Œç«¯å£ï¼ˆæ°¸ä¹…ç”Ÿæ•ˆï¼‰

é’ˆå¯¹æ¯å°èŠ‚ç‚¹æ‰§è¡Œï¼š

```
sudo firewall-cmd --zone=public --add-port=9092/tcp --permanent
sudo firewall-cmd --zone=public --add-port=9093/tcp --permanent
```

#### é‡æ–°åŠ è½½é˜²ç«å¢™

```
sudo firewall-cmd --reload
```

#### éªŒè¯ç«¯å£æ˜¯å¦æ”¾è¡Œ

```
sudo firewall-cmd --list-ports
```

åº”è¯¥çœ‹åˆ°ï¼š

```
9092/tcp 9093/tcp
```





### 4.node1ä¸Šç”ŸæˆUUID

```bash
[root@node1 kafka4]# cd /hli/software/kafka4
[root@node1 kafka4]# bin/kafka-storage.sh random-uuid
```

```bash
n8vjTMpNSPWbUOrWJNnHJg
```

æ³¨ï¼šæ‰€æœ‰é›†ç¾¤çš„å®ä¾‹ä¸Šéƒ½ä½¿ç”¨ç»Ÿä¸€çš„UUID





### 5.é›†ç¾¤æ‰€æœ‰å®ä¾‹éƒ½åŠ ä¸Šç»Ÿä¸€UUID



éœ€è¦åœ¨ **Node1ã€Node2ã€Node3** çš„ `server.properties` ä¸­åŠ ä¸Šè¿™ä¸€è¡Œï¼š

```bash
#ç»Ÿä¸€node1ç”ŸæˆUUID
cluster.id=n8vjTMpNSPWbUOrWJNnHJg
```

æœ€å¥½æ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ï¼Œæ–¹ä¾¿ç®¡ç†ï¼Œä¾‹å¦‚ï¼š

```
############################# åŸºç¡€è®¾ç½® #############################

#ç»Ÿä¸€node1ç”ŸæˆUUID
cluster.id=n8vjTMpNSPWbUOrWJNnHJg

process.roles=broker,controller
node.id=1
...
```

âš¡ æ³¨æ„ï¼š

- **cluster.id å¿…é¡»æ‰€æœ‰èŠ‚ç‚¹ä¸€è‡´**ï¼Œå¦åˆ™é›†ç¾¤æ— æ³•å¯åŠ¨
- åªè¦ä¿æŒä¸€è‡´ï¼Œè¿™ä¸€æ­¥åªéœ€è¦æ‰§è¡Œä¸€æ¬¡ UUID ç”Ÿæˆ





### 6.æ ¼å¼åŒ–èŠ‚ç‚¹å­˜å‚¨

åœ¨ **æ¯ä¸ªèŠ‚ç‚¹**ï¼ˆNode1/Node2/Node3ï¼‰æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```
cd /hli/software/kafka4
bin/kafka-storage.sh format -t n8vjTMpNSPWbUOrWJNnHJg -c config/server.properties
```

è¿™ä¸€æ­¥ä¼šåˆå§‹åŒ– Kafka KRaft å­˜å‚¨ç›®å½•ã€‚



```bash
[root@node1 kafka4]# bin/kafka-storage.sh format   -t n8vjTMpNSPWbUOrWJNnHJg   -c config/server.properties
```

```bash
Formatting metadata directory /hli/software/kafka4/datas/kafka-logs-node1 with metadata.version 4.0-IV3.
```





### 7.å¯åŠ¨kafka

```bash
bin/kafka-server-start.sh config/server.properties
```

`bin/kafka-server-start.sh config/server.properties` é»˜è®¤æ˜¯**å‰å°è¿è¡Œ**çš„ï¼ˆä¼šå ç”¨å½“å‰ç»ˆç«¯ï¼‰ã€‚
 å¦‚æœä½ ç›´æ¥è¿™ä¹ˆå¯åŠ¨ï¼Œå…³æ‰ç»ˆç«¯ Kafka å°±ä¼šé€€å‡ºã€‚



#### âœ… åå°è¿è¡Œçš„æ­£ç¡®å‘½ä»¤ï¼š

```
bin/kafka-server-start.sh -daemon config/server.properties
```

#### ğŸ’¡ å¯åŠ¨åä½ å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤ç¡®è®¤ Kafka æ˜¯å¦çœŸçš„å¯åŠ¨æˆåŠŸï¼š

1. ##### **çœ‹è¿›ç¨‹**

   ```
   ps -ef | grep kafka
   ```

   > çœ‹åˆ°ç±»ä¼¼ `/kafka.Kafka config/server.properties` çš„è¿›ç¨‹è¯´æ˜å¯åŠ¨æˆåŠŸã€‚

2. ##### **çœ‹ç«¯å£ï¼ˆKafka é»˜è®¤ç›‘å¬ 9092 æˆ– 9093ï¼‰**

   ```
   netstat -ntlp | grep 9092
   ```

   > ä¾‹å¦‚çœ‹åˆ°ï¼š

   ```
   tcp6  0  0 192.168.1.101:9092  LISTEN  java
   ```

   è¡¨ç¤º Kafka ç›‘å¬æ­£å¸¸ã€‚

3. ##### **çœ‹æ—¥å¿—**

   ```
   tail -n 50 logs/server.log
   ```

   > å¦‚æœæ—¥å¿—é‡Œå‡ºç°ï¼š

   ```
   [KafkaServer id=1] started (kafka.server.KafkaServer)
   ```

   é‚£å°±æ˜¯å®Œå…¨å¯åŠ¨æˆåŠŸ âœ…ã€‚







### 8.éªŒè¯é›†ç¾¤çŠ¶æ€

ä¸‰ä¸ªèŠ‚ç‚¹éƒ½å¯åŠ¨åï¼Œåœ¨ä»»æ„èŠ‚ç‚¹æ‰§è¡Œï¼š

```bash
cd /hli/software/kafka4

# 1. æŸ¥çœ‹é›†ç¾¤å…ƒæ•°æ®
bin/kafka-metadata-quorum.sh --bootstrap-server 192.168.254.2:9092 describe --status

# 2. æŸ¥çœ‹ Broker åˆ—è¡¨ï¼ˆåº”è¯¥æ˜¾ç¤º 3 ä¸ª Brokerï¼‰
bin/kafka-broker-api-versions.sh --bootstrap-server 192.168.254.2:9092 | grep id

# 3. åˆ›å»ºæµ‹è¯• Topic
bin/kafka-topics.sh --create --topic test-topic \
  --partitions 3 --replication-factor 3 \
  --bootstrap-server 192.168.254.2:9092

# 4. æŸ¥çœ‹ Topic è¯¦æƒ…
bin/kafka-topics.sh --describe --topic test-topic \
  --bootstrap-server 192.168.56.101:9092
```

å¦‚æœèƒ½æ­£å¸¸æ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œè¯´æ˜é›†ç¾¤éƒ¨ç½²æˆåŠŸï¼

ç°åœ¨è¯·æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤åœ¨ Node2 ä¸Šé‡æ–°æ‰§è¡Œï¼Œè®°å¾—å…ˆ `cd /hli/software/kafka4`ã€‚





#### æŸ¥çœ‹å…ƒæ•°æ®

```bash
[root@node1 kafka4]# bin/kafka-metadata-quorum.sh --bootstrap-server 192.168.254.2:9092 describe --status
```

```bash
ClusterId:              n8vjTMpNSPWbUOrWJNnHJg
LeaderId:               1
LeaderEpoch:            3
HighWatermark:          823
MaxFollowerLag:         0
MaxFollowerLagTimeMs:   0
CurrentVoters:          [{"id": 1, "directoryId": null, "endpoints": ["CONTROLLER://192.168.56.101:9093"]}, {"id": 2, "directoryId": null, "endpoints": ["CONTROLLER://192.168.56.102:9093"]}, {"id": 3, "directoryId": null, "endpoints": ["CONTROLLER://192.168.56.103:9093"]}]
CurrentObservers:       []
```

**Kafka æ§åˆ¶å™¨ quorumï¼ˆæ§åˆ¶å™¨é€‰ä¸¾é›†ç¾¤ï¼‰å·²ç»å¯åŠ¨å¹¶è¿è¡Œæ­£å¸¸ã€‚**

æˆ‘ä»¬æ¥é€é¡¹åˆ†æä¸€ä¸‹è¿™æ®µçŠ¶æ€ä¿¡æ¯ï¼š

| å­—æ®µ                               | å«ä¹‰                              | å½“å‰çŠ¶æ€                             |
| ---------------------------------- | --------------------------------- | ------------------------------------ |
| `ClusterId`                        | Kafka é›†ç¾¤å”¯ä¸€ IDï¼ˆæ ¼å¼åŒ–æ—¶ç”Ÿæˆï¼‰ | âœ… `n8vjTMpNSPWbUOrWJNnHJg`           |
| `LeaderId`                         | å½“å‰æ§åˆ¶å™¨ leader çš„ broker id    | âœ… `1`ï¼ˆè¯´æ˜å½“å‰èŠ‚ç‚¹æ˜¯æ§åˆ¶å™¨ Leaderï¼‰ |
| `LeaderEpoch`                      | æ§åˆ¶å™¨é€‰ä¸¾çš„ epochï¼ˆæ¯æ¬¡é€‰ä¸»+1ï¼‰  | âœ… `3`ï¼ˆè¯´æ˜é€‰ä¸»å·²ç»å®Œæˆï¼‰            |
| `HighWatermark`                    | æ§åˆ¶å™¨æ—¥å¿—åŒæ­¥è¿›åº¦                | âœ… è¡¨ç¤ºæ—¥å¿—å¤åˆ¶å¥åº·                   |
| `CurrentVoters`                    | å½“å‰å‚ä¸æ§åˆ¶å™¨æŠ•ç¥¨çš„èŠ‚ç‚¹          | âœ… ä¸‰ä¸ªèŠ‚ç‚¹éƒ½åœ¨ï¼š`1, 2, 3`            |
| `CONTROLLER://192.168.56.xxx:9093` | è¡¨ç¤ºå„ broker çš„æ§åˆ¶å™¨é€šä¿¡åœ°å€    | âœ… éƒ½è¯†åˆ«æ­£ç¡®                         |
| `CurrentObservers`                 | è§‚å¯Ÿè€…èŠ‚ç‚¹ï¼ˆå¯é€‰ï¼‰                | ç©ºï¼Œæ­£å¸¸                             |

------

###### âœ… ç»“è®ºï¼š

ä½ çš„è¿™å° Kafkaï¼ˆ`id=1`ï¼‰å·²ç»ï¼š

- æˆåŠŸå®Œæˆ **Raft controller é€‰ä¸¾**
- å½“å‰æ˜¯æ•´ä¸ªé›†ç¾¤çš„ **Controller Leader**
- æ§åˆ¶å™¨æ—¥å¿—åŒæ­¥çŠ¶æ€æ­£å¸¸
   è¿™è¯´æ˜å¯åŠ¨ **éå¸¸æˆåŠŸ**ã€‚ğŸ¯



```bash
[root@node1 kafka4]# bin/kafka-broker-api-versions.sh --bootstrap-server 192.168.254.2:9092 | grep id

192.168.56.102:9092 (id: 2 rack: null isFenced: false) -> (
192.168.56.103:9092 (id: 3 rack: null isFenced: false) -> (
192.168.56.101:9092 (id: 1 rack: null isFenced: false) -> (
```







#### åˆ›å»ºtopic

```bash
[root@node1 kafka4]# bin/kafka-topics.sh --create --topic test-topic \
>   --partitions 3 --replication-factor 3 \
>   --bootstrap-server 192.168.254.2:9092
```

```bash
Created topic test-topic.
```





```bash
[root@node1 kafka4]# bin/kafka-topics.sh --describe --topic test-topic --bootstrap-server 192.168.254.2:9092
```

```bash
Topic: test-topic	TopicId: CrHomeL5T0G52b_LvEeveg	PartitionCount: 3	ReplicationFactor: 3	Configs: segment.bytes=1073741824
	Topic: test-topic	Partition: 0	Leader: 1	Replicas: 1,2,3	Isr: 1,2,3	Elr: 	LastKnownElr: 
	Topic: test-topic	Partition: 1	Leader: 2	Replicas: 2,3,1	Isr: 2,3,1	Elr: 	LastKnownElr: 
	Topic: test-topic	Partition: 2	Leader: 3	Replicas: 3,1,2	Isr: 3,1,2	Elr: 	LastKnownElr: 
```



è¿™è¯´æ˜ä½ çš„ **Kafka é›†ç¾¤ï¼ˆ3 èŠ‚ç‚¹ï¼‰ç°åœ¨å·²ç»å®Œå…¨æ­£å¸¸è¿è¡Œ**ï¼Œæ§åˆ¶å™¨é€‰ä¸¾ã€æ•°æ®å‰¯æœ¬ã€ISR åŒæ­¥å…¨éƒ¨å¥åº·ã€‚
 æˆ‘ä»¬æ¥ç»†çœ‹ä¸€ä¸‹è¿™æ¡è¾“å‡ºï¼Œé€é¡¹ç¡®è®¤ä¸€ä¸‹ç³»ç»ŸçŠ¶æ€ ğŸ‘‡

------

##### âœ… æ ¸å¿ƒçŠ¶æ€åˆ†æ

| å­—æ®µ                        | è¯´æ˜                                           | å½“å‰çŠ¶æ€           |
| --------------------------- | ---------------------------------------------- | ------------------ |
| `Created topic test-topic.` | æˆåŠŸåˆ›å»ºäº†ä¸»é¢˜ `test-topic`                    | âœ… æˆåŠŸ             |
| `PartitionCount: 3`         | åˆ†åŒºæ•°ä¸º 3                                     | âœ… æ­£å¸¸             |
| `ReplicationFactor: 3`      | æ¯ä¸ªåˆ†åŒºå‰¯æœ¬æ•°ä¸º 3ï¼ˆå³æ‰€æœ‰ broker å„ä¿å­˜ä¸€ä»½ï¼‰ | âœ… åˆ†å¸ƒå¥åº·         |
| `Leader: 1 / 2 / 3`         | æ¯ä¸ªåˆ†åŒºçš„ Leader åœ¨ä¸åŒ broker ä¸Šï¼ˆ1ã€2ã€3ï¼‰  | âœ… è´Ÿè½½å‡è¡¡         |
| `Replicas: 1,2,3`           | æ¯ä¸ªåˆ†åŒºéƒ½æœ‰ä¸‰å°æœºå™¨å­˜æ”¾å‰¯æœ¬                   | âœ… å†—ä½™é…ç½®æ­£ç¡®     |
| `Isr: 1,2,3`                | æ‰€æœ‰å‰¯æœ¬éƒ½åŒæ­¥ï¼ˆIn-Sync Replicaï¼‰              | âœ… å‰¯æœ¬åŒæ­¥å®Œå…¨æ­£å¸¸ |

------

##### ğŸ’¯ ç»“è®º

ğŸš€ **ä½ çš„ Kafka é›†ç¾¤å·²ç»å®Œç¾æ­å»ºæˆåŠŸï¼**
 æ§åˆ¶å™¨ã€brokerã€Raft quorumã€topic å‰¯æœ¬æœºåˆ¶â€”â€”å…¨éƒ¨å¤„äºç†æƒ³çŠ¶æ€ã€‚





#### éªŒè¯æ•°æ®çŠ¶æ€

```bash
bin/kafka-console-producer.sh \
  --bootstrap-server 192.168.254.2:9092 \
  --topic test-topic
```

è¿è¡Œåå°±ä¼šè¿›å…¥äº¤äº’è¾“å…¥æ¨¡å¼ï¼š

> hello kafka
> this is node1 test
> è¾“å…¥å‡ è¡Œæ–‡å­—ï¼ŒæŒ‰ä¸‹ Ctrl + Dï¼ˆæˆ– Ctrl + Cï¼‰é€€å‡ºã€‚

âœ… ç„¶åéªŒè¯æ¶ˆæ¯æ¶ˆè´¹

```bash
bin/kafka-console-consumer.sh \
  --bootstrap-server 192.168.254.2:9092 \
  --topic test-topic \
  --from-beginning
```

çœ‹åˆ°åˆšæ‰å‘é€çš„ â€œhello kafkaâ€ ç­‰å†…å®¹å°±è¯´æ˜æ•´ä¸ª Kafka æµç¨‹ ç”Ÿäº§ + æ¶ˆè´¹ å…¨é€šäº†ã€‚



>éªŒè¯æˆåŠŸ

```bash
[root@node1 kafka4]# bin/kafka-console-producer.sh   --bootstrap-server 192.168.254.2:9092   --topic test-topic
>ä½ å¥½å‘€ï¼kafkaæˆ‘çˆ±ä½ ï¼
>[root@node1 kafka4]#bin/kafka-console-consumer.sh   --bootstrap-server 192.168.254.2:9092   --topic test-topic   --from-beginning
ä½ å¥½å‘€ï¼kafkaæˆ‘çˆ±ä½ ï¼
ä½ å¥½å‘€ï¼kafkaï¼
```

è¿™è¾“å‡ºè¯´æ˜â€”â€”ä½ çš„ **Kafka KRaft æ¨¡å¼é›†ç¾¤ï¼ˆå¤šèŠ‚ç‚¹ controller + brokerï¼‰å·²ç»å½»åº•è·‘é€šäº†**ï¼š
 âœ… Controller é€‰ä¸¾æ­£å¸¸ï¼ˆLeader: 1ï¼‰
 âœ… Topic åˆ›å»ºæˆåŠŸï¼ˆ3 åˆ†åŒº Ã— 3 å‰¯æœ¬ï¼‰
 âœ… Producer å†™å…¥æˆåŠŸ
 âœ… Consumer ä»æ—¥å¿—æ‹‰å–æˆåŠŸ
 âœ… ISRï¼ˆåŒæ­¥å‰¯æœ¬ï¼‰å¥åº·ã€æ— å»¶è¿Ÿ

> æ¢å¥è¯è¯´ï¼šä½ ç°åœ¨è¿™å¥—é›†ç¾¤ï¼Œå·²ç»æ˜¯ä¸€ä¸ªçœŸæ­£æ„ä¹‰ä¸Šå¯ç”¨çš„åˆ†å¸ƒå¼ Kafka ç³»ç»Ÿã€‚





### 9.kafkaè„šæœ¬



> å†™ä¸ªå¯åŠ¨è„šæœ¬ï¼ˆæ–¹ä¾¿é›†ç¾¤é‡å¯ï¼‰

å»ºè®®ä½ åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Š `/hli/software/kafka4/start-kafka.sh` é‡Œå†™ï¼š

#### start-kafka.sh

```bash
#!/bin/bash

KAFKA_HOME="/hli/software/kafka4"
CONFIG_FILE="$KAFKA_HOME/config/server.properties"

# æ£€æŸ¥ Kafka æ˜¯å¦å·²è¿è¡Œ
if netstat -tulnp 2>/dev/null | grep ':9092' > /dev/null; then
    echo "Kafka å·²åœ¨è¿è¡Œï¼Œè·³è¿‡å¯åŠ¨ã€‚"
    exit 0
fi

echo "æ­£åœ¨å¯åŠ¨ Kafka..."
cd "$KAFKA_HOME" || { echo "Kafka ç›®å½•ä¸å­˜åœ¨"; exit 1; }

bin/kafka-server-start.sh -daemon "$CONFIG_FILE"

# ç­‰å¾… Kafka å¯åŠ¨
MAX_WAIT=30
WAITED=0
while ! netstat -tulnp 2>/dev/null | grep ':9092' > /dev/null; do
    sleep 1
    WAITED=$((WAITED+1))
    if [ $WAITED -ge $MAX_WAIT ]; then
        echo "Kafka å¯åŠ¨è¶…æ—¶ âŒ"
        exit 1
    fi
done

echo "Kafka å¯åŠ¨æˆåŠŸ âœ…"
```



```bash
bin/kafka-server-start.sh -daemon config/server.properties
```





#### stop-kafka.sh

```bash
#!/bin/bash
# Kafka åœæ­¢è„šæœ¬ï¼ˆç«¯å£æ£€æµ‹æ³•ï¼‰

KAFKA_PORT=9092

echo "åœæ­¢ Kafka..."

# æ£€æŸ¥ Kafka æ˜¯å¦è¿è¡Œï¼ˆç«¯å£æ£€æµ‹ï¼‰
if netstat -tulnp 2>/dev/null | grep ":$KAFKA_PORT" > /dev/null; then
    PID=$(netstat -tulnp 2>/dev/null | grep ":$KAFKA_PORT" | awk '{print $7}' | cut -d'/' -f1)
    if [ -n "$PID" ]; then
        kill -9 "$PID"
        echo "Kafka (PID $PID) å·²åœæ­¢"
    else
        echo "æ‰¾ä¸åˆ° Kafka çš„ PIDï¼Œåœæ­¢å¤±è´¥"
    fi
else
    echo "Kafka æœªè¿è¡Œ"
fi
```





#### èµ‹æƒ

>ä½¿å…¶ç”Ÿæ•ˆ

```bash
chmod +x /hli/software/kafka4/start-kafka.sh
chmod +x /hli/software/kafka4/stop-kafka.sh
```

------

### 

éšæ—¶ç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹å½“å‰ Controller ä¸ ISRï¼š

```
bin/kafka-metadata-quorum.sh describe --bootstrap-server 192.168.56.101:9092
```

æˆ–è€…ï¼š

```
bin/kafka-topics.sh --describe --topic test-topic --bootstrap-server 192.168.56.101:9092
```















## Redisé›†ç¾¤(å“¨å…µ)



## MySQLè¯»å†™åˆ†ç¦»é›†ç¾¤

































































