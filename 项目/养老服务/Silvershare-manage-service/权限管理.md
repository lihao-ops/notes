权限管理功能
===



### 说明

通过权限管理实现对用户身份及角色拥有的权限管理



### 一、角色

一个用户对应一个角色

登录用户所属角色，可有默认角色：

#### 1.超级管理员

拥有所有角色拥有的权限，以及其独有权限

#### 2.管理员

在员工的基础上再拥有其独有权限

#### 3.员工

普通权限



### 二、权限

每个角色下所拥有特定的访问接口权限

而每个路径都是逐个添加到每个角色对应拥有的权限。

![manage服务权限管理表间关系图](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202310040106623.jpg)



### 三、菜单

菜单分为：

- 一级
- 二级
- 三级



每个菜单都拥有权重以后续按照权重对应接口数据返回顺序

 









### 四、页面说明





#### 一、员工管理



##### 1.信息列表

>进入方式

![image-20230925195817154](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202309251958482.png)

>调用接口

![image-20230925195855023](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202309251958121.png)



##### 2.信息编辑

>进入方式

![image-20230925200029714](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202309252000842.png)



>调用接口

编辑员工信息接口





##### 3.员工新增

>进入方式

![image-20230925200155675](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202309252001807.png)



>调用接口

员工新增接口







#### 二、菜单管理

##### 1.菜单列表

>进入方式

![image-20230925200811064](https://notes-1307435281.cos.ap-shanghai.myqcloud.com/note/master/202309252008244.png)



>调用接口

菜单列表(根据角色id查询当前角色所拥有的菜单信息)















```java
思路：
1.每次请求进来先通过session_id去数据库查询user_id和expire_time
	1.1 如果没有对应的用户信息session，或者session_id已失效，则提示登录(403)
    1.2 如果有用户的session对应的(user_id和expire_time),则先更新用户expire_time为当前时间
2.根据当前账号信息匹配用户对应角色所拥有的所有权限
    2.1 如果没有任何权限则直接返回401
    2.2 如果有,则加载用户对应角色的所有权限属性路径
3.截取当前请求url对应permission_code的部分进行对比
    3.1 权限遍历校验 
```



